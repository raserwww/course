1
00:00:00,000 --> 00:00:02,000
 you

2
00:00:30,000 --> 00:00:32,000
 you

3
00:01:00,000 --> 00:01:02,000
 you

4
00:01:30,000 --> 00:01:32,000
 you

5
00:02:00,000 --> 00:02:02,000
 you

6
00:02:30,000 --> 00:02:32,000
 you

7
00:03:00,000 --> 00:03:02,000
 you

8
00:03:30,000 --> 00:03:32,000
 you

9
00:04:00,000 --> 00:04:02,000
 you

10
00:04:30,000 --> 00:04:32,000
 you

11
00:05:00,000 --> 00:05:02,000
 you

12
00:05:30,000 --> 00:05:32,000
 you

13
00:06:00,000 --> 00:06:02,000
 you

14
00:06:30,000 --> 00:06:32,000
 you

15
00:07:00,000 --> 00:07:02,000
 you

16
00:07:30,000 --> 00:07:32,000
 you

17
00:08:00,000 --> 00:08:02,000
 you

18
00:08:30,000 --> 00:08:32,000
 you

19
00:09:00,000 --> 00:09:26,000
 you

20
00:09:26,000 --> 00:09:31,000
 you

21
00:09:31,000 --> 00:09:33,000
 you

22
00:09:33,000 --> 00:09:49,000
 Okay, so this is the outline for TS class. So first we will give an introduction for this structure from motion, this concept.

23
00:09:49,000 --> 00:09:55,400
 And then we'll talk about pose reconstruction.

24
00:09:55,400 --> 00:09:59,440
 So direction from motion is about finding the geometry

25
00:09:59,440 --> 00:10:02,640
 for imaging systems.

26
00:10:20,000 --> 00:10:24,520
 If we give an explanation, it is

27
00:10:24,520 --> 00:10:31,360
 to find 3D structures from images or videos.

28
00:10:49,600 --> 00:10:59,680
 Pose reconstruction, it is to find a position plus orientation.

29
00:10:59,680 --> 00:11:01,520
 It is a six dimensional vector.

30
00:11:19,000 --> 00:11:27,400
 For the technical details, in today's class,

31
00:11:27,400 --> 00:11:30,720
 we'll talk about two concepts.

32
00:11:30,720 --> 00:11:33,080
 One of them is called the essential matrix.

33
00:11:33,080 --> 00:11:35,720
 The other is called the homography matrix.

34
00:11:35,720 --> 00:11:40,160
 So these are two concepts for multi-view geometry.

35
00:11:40,160 --> 00:11:44,680
 They can connect to the images through three dimensional

36
00:11:44,680 --> 00:11:46,920
 space.

37
00:11:46,920 --> 00:11:52,520
 To find the essential matrix, we will go through one algorithm

38
00:11:52,520 --> 00:11:55,760
 called a point algorithm.

39
00:11:55,760 --> 00:12:01,520
 This means this method need eight feature points.

40
00:12:01,520 --> 00:12:06,040
 For homography matrix, we will use one algorithm called

41
00:12:06,040 --> 00:12:10,839
 four point algorithm, which requires four feature points

42
00:12:10,839 --> 00:12:13,000
 at least.

43
00:12:13,000 --> 00:12:15,920
 So this is the outline for today's class.

44
00:12:15,920 --> 00:12:20,240
 And for this stereo vision and optical flow,

45
00:12:20,240 --> 00:12:24,040
 they can be useful for robotics, but we will not

46
00:12:24,040 --> 00:12:25,599
 cover them in this class.

47
00:12:32,520 --> 00:12:38,439
 OK, in this class, we will answer the framework briefly.

48
00:12:38,439 --> 00:12:43,520
 This framework is used for vision based control

49
00:12:43,520 --> 00:12:48,240
 and state estimation.

50
00:12:48,240 --> 00:12:52,400
 We can start from the control object.

51
00:12:52,400 --> 00:12:58,480
 It can be a robot, either flying or mobile on the ground.

52
00:13:02,240 --> 00:13:06,480
 We first need sensors to do sensing and the perception.

53
00:13:06,480 --> 00:13:11,360
 In this framework, the main sensor is a vision sensor,

54
00:13:11,360 --> 00:13:12,840
 camera.

55
00:13:12,840 --> 00:13:25,800
 Other than cameras, we can also have GPS or MU, INS,

56
00:13:25,800 --> 00:13:31,720
 or laser, or encoded, et cetera.

57
00:13:31,720 --> 00:13:35,800
 So nowadays, usually for one robotic system,

58
00:13:35,800 --> 00:13:41,280
 there are multiple sensors.

59
00:13:41,280 --> 00:13:46,000
 They can increase the reliability and robustness.

60
00:13:49,079 --> 00:13:51,720
 If we use just one kind of sensor, for example,

61
00:13:51,720 --> 00:13:57,600
 only camera sensor, then sometimes for certain environments,

62
00:13:57,600 --> 00:14:00,839
 the cameras may not be able to handle.

63
00:14:00,839 --> 00:14:05,120
 So in this class, I like to use Tesla as an example.

64
00:14:05,120 --> 00:14:08,079
 And you know that since last week,

65
00:14:08,080 --> 00:14:12,000
 Tesla is under investigation by the USA government

66
00:14:12,000 --> 00:14:18,000
 because of several accidents with their autopilot system.

67
00:14:18,000 --> 00:14:23,440
 So Tesla is very innovative, using only cameras.

68
00:14:23,440 --> 00:14:28,800
 But nowadays, we're not sure whether cameras are enough

69
00:14:28,800 --> 00:14:32,360
 for autonomous driving or not.

70
00:14:32,360 --> 00:14:36,840
 If it can be done, definitely it is very impressive

71
00:14:36,880 --> 00:14:38,880
 and very innovative.

72
00:14:38,880 --> 00:14:42,920
 OK, anyhow, we can have multiple sensors

73
00:14:42,920 --> 00:14:45,800
 for a robotic system.

74
00:14:45,800 --> 00:14:50,080
 And then based on images, we can do a structure for motion.

75
00:14:50,080 --> 00:14:52,280
 We can do post reconstruction, et cetera.

76
00:15:07,280 --> 00:15:08,280
 OK.

77
00:15:08,280 --> 00:15:14,480
 So this is about the process to go from 2D to 3D.

78
00:15:14,480 --> 00:15:24,080
 So from 2D images, we try to figure out some 3D information.

79
00:15:29,080 --> 00:15:33,280
 So after all these estimation, state estimation,

80
00:15:33,720 --> 00:15:40,360
 geometric estimation, et cetera, are completed,

81
00:15:40,360 --> 00:15:45,280
 then we can use those variables or states

82
00:15:45,280 --> 00:15:48,319
 to control the motion of the robot.

83
00:15:48,319 --> 00:15:51,640
 So then the robot can do some tasks.

84
00:15:51,640 --> 00:16:03,640
 So structure from motion.

85
00:16:03,640 --> 00:16:11,280
 This was once a very hard topic in about maybe, let's say,

86
00:16:11,280 --> 00:16:12,120
 15 years ago.

87
00:16:12,120 --> 00:16:12,620
 All right.

88
00:16:21,120 --> 00:16:23,760
 Let's see what it is about.

89
00:16:23,760 --> 00:16:27,840
 Given two images of matched feature points,

90
00:16:27,840 --> 00:16:30,880
 so we can determine some states or variables.

91
00:16:34,400 --> 00:16:37,960
 Let me drop briefly two images.

92
00:16:37,960 --> 00:16:40,720
 So here in this class, we focus more on geometry.

93
00:16:42,560 --> 00:16:46,600
 And on these two images, let's assume

94
00:16:46,600 --> 00:16:50,240
 that we have a number of feature points.

95
00:16:50,240 --> 00:16:55,280
 Say, for example, four feature points.

96
00:16:55,280 --> 00:16:57,280
 We use 1, 2, 3, 4 to represent them.

97
00:16:57,280 --> 00:16:57,780
 All right.

98
00:17:11,079 --> 00:17:14,399
 So this is one image.

99
00:17:14,399 --> 00:17:17,760
 And on the other image, we also have four feature points.

100
00:17:28,040 --> 00:17:40,040
 So these are two images with four matched feature points.

101
00:17:51,200 --> 00:17:55,160
 OK, so let me write a bit bigger so that you

102
00:17:55,160 --> 00:17:56,560
 can see this clearly.

103
00:18:05,680 --> 00:18:08,880
 To find matched feature points, it is not difficult.

104
00:18:08,880 --> 00:18:14,120
 So we can just use some computer vision

105
00:18:14,120 --> 00:18:16,440
 algorithms to do it.

106
00:18:16,440 --> 00:18:16,940
 All right.

107
00:18:21,360 --> 00:18:30,080
 And between the camera poses, taking these two images,

108
00:18:30,080 --> 00:18:34,200
 we assume that this rotation R and a translation

109
00:18:34,200 --> 00:18:36,520
 X between them.

110
00:18:36,520 --> 00:18:37,020
 All right.

111
00:18:37,020 --> 00:18:40,120
 So for structure from motion, one objective

112
00:18:40,120 --> 00:18:45,840
 is to figure out the rotation and the translation.

113
00:18:45,840 --> 00:18:50,040
 That separates these two camera views.

114
00:18:50,040 --> 00:18:54,959
 That's one objective for this structure from motion.

115
00:18:54,959 --> 00:19:00,520
 The second objective is to find the relative structure

116
00:19:00,520 --> 00:19:02,199
 of the feature points being viewed.

117
00:19:05,439 --> 00:19:13,800
 These two objectives are both about geometry

118
00:19:13,800 --> 00:19:14,720
 in computer vision.

119
00:19:16,199 --> 00:19:24,240
 And in this structure from motion,

120
00:19:24,240 --> 00:19:27,919
 we assume that the feature points have already

121
00:19:27,919 --> 00:19:32,040
 been identified and matched between two views.

122
00:19:32,040 --> 00:19:35,720
 So that means we need two steps, feature point detection

123
00:19:35,720 --> 00:19:37,800
 and feature point tracking.

124
00:19:37,800 --> 00:19:38,000
 All right.

125
00:19:38,000 --> 00:19:40,800
 So for these two tasks, nowadays the techniques

126
00:19:40,800 --> 00:19:41,639
 are very mature.

127
00:19:41,639 --> 00:19:43,040
 So they can be done very easily.

128
00:19:45,840 --> 00:19:55,040
 And this topic is called structure from motion.

129
00:19:55,040 --> 00:19:59,120
 So in addition to this topic, structure from motion,

130
00:19:59,120 --> 00:20:02,679
 there's another topic very useful for robotics.

131
00:20:06,120 --> 00:20:06,620
 Slam.

132
00:20:09,600 --> 00:20:12,439
 If we use a camera, then we have this vision-based slam.

133
00:20:16,840 --> 00:20:19,199
 All right.

134
00:20:19,199 --> 00:20:21,199
 So for structure from motion, we only

135
00:20:21,199 --> 00:20:23,320
 get these two pieces of information.

136
00:20:23,320 --> 00:20:29,320
 But for slam, we're going to get a map of the environment

137
00:20:29,320 --> 00:20:34,240
 and also locations, localization.

138
00:20:34,240 --> 00:20:40,919
 So they're more direct towards robotic applications.

139
00:20:41,280 --> 00:20:48,920
 Usually for different situations or things,

140
00:20:48,920 --> 00:20:53,760
 we require different methods for reconstruction.

141
00:20:53,760 --> 00:20:57,600
 And usually these methods are linear.

142
00:20:57,600 --> 00:21:00,920
 So we can use some simple mathematics,

143
00:21:00,920 --> 00:21:03,600
 such as linear algebra, to handle them.

144
00:21:03,600 --> 00:21:13,480
 So this is a very brief introduction

145
00:21:13,480 --> 00:21:15,199
 for this structure from motion.

146
00:21:22,399 --> 00:21:25,959
 In this class, we focus on geometry.

147
00:21:25,959 --> 00:21:29,199
 So here in these three reference books,

148
00:21:29,199 --> 00:21:33,439
 they all have this geometry focus.

149
00:21:33,440 --> 00:21:40,320
 The first reference book, multiple view geometry

150
00:21:40,320 --> 00:21:42,280
 in computation.

151
00:21:42,280 --> 00:21:47,080
 And number two, the geometry of multiple images.

152
00:21:49,920 --> 00:21:56,880
 And number three, an imitation to 3D vision

153
00:21:56,880 --> 00:21:58,960
 from images to geometric models.

154
00:22:04,440 --> 00:22:08,440
 OK.

155
00:22:08,440 --> 00:22:10,680
 And why do we need this kind of multi-view geometry?

156
00:22:10,680 --> 00:22:16,840
 Because they kind of bridge the 2D images and the 3D space.

157
00:22:24,040 --> 00:22:32,840
 And in this multi-view geometry, one state to be found out

158
00:22:32,840 --> 00:22:34,040
 is the relative pose.

159
00:22:41,439 --> 00:22:44,040
 It means a position plus orientation.

160
00:22:54,159 --> 00:22:57,000
 Or in another way, you can just call them

161
00:22:57,000 --> 00:22:58,919
 a translation plus rotation.

162
00:23:03,840 --> 00:23:06,320
 OK.

163
00:23:06,320 --> 00:23:09,639
 When we consider the motion of a robot,

164
00:23:09,639 --> 00:23:13,040
 so usually we consider the translation,

165
00:23:13,040 --> 00:23:15,720
 like how much distance the robot needs to travel,

166
00:23:15,720 --> 00:23:18,040
 and also the rotation.

167
00:23:18,040 --> 00:23:21,520
 So how many angles the robot needs to rotate.

168
00:23:29,600 --> 00:23:30,100
 OK.

169
00:23:33,080 --> 00:23:37,679
 For robotic programming, there are many software resources

170
00:23:37,679 --> 00:23:41,760
 for us to use, specifically for structure from motion

171
00:23:41,760 --> 00:23:42,959
 programming.

172
00:23:42,959 --> 00:23:47,000
 You can use many or quite a few programming languages,

173
00:23:47,000 --> 00:23:53,280
 such as C++ or Python.

174
00:23:53,280 --> 00:23:56,679
 In terms of programming environment,

175
00:23:56,680 --> 00:24:05,200
 you can use Matlab or ROS for robots.

176
00:24:05,200 --> 00:24:08,920
 ROS1 in the past, there was ROS1, now we have ROS2.

177
00:24:15,760 --> 00:24:22,520
 The first resource is based on C++.

178
00:24:22,520 --> 00:24:24,400
 This is OpenCV.

179
00:24:24,440 --> 00:24:27,840
 And the third one is from Matlab.

180
00:24:33,040 --> 00:24:35,080
 And if you like to use Python, you

181
00:24:35,080 --> 00:24:37,680
 can also find some Python-based toolboxes.

182
00:24:37,680 --> 00:24:41,080
 There are a lot of these kind of toolboxes online available.

183
00:24:48,160 --> 00:24:50,480
 A little bit history about the structure from motion.

184
00:24:50,480 --> 00:24:53,000
 So this is about geometry.

185
00:24:53,000 --> 00:24:58,200
 So it has a long history.

186
00:24:58,200 --> 00:25:02,480
 The scientists, you can lead, or the mathematicians,

187
00:25:02,480 --> 00:25:07,160
 you can lead, develop the notions of perspective

188
00:25:07,160 --> 00:25:08,040
 and projection.

189
00:25:14,560 --> 00:25:20,200
 So nowadays, these concepts look very simple to us.

190
00:25:20,200 --> 00:25:23,880
 But in 2000 years ago, it was not easy.

191
00:25:27,280 --> 00:25:36,160
 And then in the next about 1,000 plus years,

192
00:25:36,160 --> 00:25:41,280
 these two concepts were really discovered,

193
00:25:41,280 --> 00:25:45,720
 especially during this period in Europe.

194
00:25:45,720 --> 00:25:46,440
 Relations.

195
00:25:47,440 --> 00:25:50,640
 So in Chinese, it is called the Wenyi Fuxian.

196
00:25:50,640 --> 00:25:52,680
 Just to let you know.

197
00:25:52,680 --> 00:25:57,440
 And then in 1913, this researcher

198
00:25:57,440 --> 00:26:04,520
 proved that two camera views of five Euclidean points

199
00:26:04,520 --> 00:26:09,080
 could be used to estimate translation and rotation,

200
00:26:09,080 --> 00:26:12,080
 separation of the two camera views.

201
00:26:12,399 --> 00:26:18,399
 So these were an early stage results for the structure

202
00:26:18,399 --> 00:26:19,000
 from motion.

203
00:26:22,199 --> 00:26:28,399
 The two key results were invented in 1981 and 1988,

204
00:26:28,399 --> 00:26:29,360
 respectively.

205
00:26:29,360 --> 00:26:31,879
 And even today, they are very commonly used.

206
00:26:36,840 --> 00:26:39,520
 There were many results on the structure from motion.

207
00:26:39,520 --> 00:26:42,200
 There were many results on the structure from motion.

208
00:26:42,200 --> 00:26:46,160
 But these two were what are seminal work,

209
00:26:46,160 --> 00:26:49,000
 or the key results.

210
00:26:49,000 --> 00:26:53,360
 In 1991, this researcher introduced

211
00:26:53,360 --> 00:26:57,120
 the essential matrix and a point algorithm.

212
00:26:57,120 --> 00:26:59,720
 So this is what we are going to cover in today's class,

213
00:26:59,720 --> 00:27:02,520
 and we'll talk about the details a bit later.

214
00:27:02,520 --> 00:27:04,280
 Let's call this one method one.

215
00:27:10,520 --> 00:27:15,960
 Seven years later, these two researchers

216
00:27:15,960 --> 00:27:21,920
 introduced the homography matrix and a four point algorithm

217
00:27:21,920 --> 00:27:29,240
 in 1988 to solve for translation and rotation,

218
00:27:29,240 --> 00:27:32,879
 giving four co-planned points.

219
00:27:32,879 --> 00:27:36,600
 These two methods have different requirements.

220
00:27:36,600 --> 00:27:44,000
 The first method requires eight non-coplanar points.

221
00:27:44,000 --> 00:27:46,439
 So that means, for this eight points,

222
00:27:46,439 --> 00:27:48,480
 they cannot be on the same plane.

223
00:27:52,879 --> 00:27:58,320
 So from these eight points, the rotation and the scale

224
00:27:58,320 --> 00:28:00,199
 of translation can be recovered.

225
00:28:00,199 --> 00:28:02,600
 So here we call it a scale translation

226
00:28:02,600 --> 00:28:09,840
 because the absolute translation cannot be found out

227
00:28:09,840 --> 00:28:13,600
 due to this loss of depth information.

228
00:28:16,399 --> 00:28:28,199
 In method two, the homography method, four co-planned points

229
00:28:28,200 --> 00:28:29,000
 are required.

230
00:28:35,240 --> 00:28:37,920
 These four points should be on the same plane,

231
00:28:37,920 --> 00:28:39,560
 but they cannot be on the same line.

232
00:28:59,200 --> 00:29:04,920
 So these are requirements for using homography.

233
00:29:04,920 --> 00:29:06,800
 And from these four points, similarly,

234
00:29:06,800 --> 00:29:10,360
 we can also find the rotation and scale translation.

235
00:29:15,000 --> 00:29:20,160
 And these are in 1996 and 2004.

236
00:29:20,160 --> 00:29:23,240
 Two researchers introduced five point algorithms,

237
00:29:23,240 --> 00:29:30,840
 but they are not as commonly used as these two methods,

238
00:29:30,840 --> 00:29:34,800
 method one and method two.

239
00:29:34,800 --> 00:29:38,160
 So what are we going to focus in today's class?

240
00:29:53,240 --> 00:30:01,720
 OK.

241
00:30:01,720 --> 00:30:07,160
 For the structure from motion, it is based on linear algebra.

242
00:30:07,160 --> 00:30:13,320
 So now we're going to review some useful tools

243
00:30:13,320 --> 00:30:14,720
 in linear algebra.

244
00:30:14,720 --> 00:30:20,280
 The first one is called SVD, single value decomposition.

245
00:30:20,280 --> 00:30:25,920
 An animatrix can be decomposed into a product

246
00:30:25,920 --> 00:30:30,160
 of three matrices, u, sigma, v.

247
00:30:30,160 --> 00:30:34,040
 So this m is animatrix.

248
00:30:34,040 --> 00:30:37,080
 And this sigma is a diagonal matrix

249
00:30:37,080 --> 00:30:41,560
 with the diagonal elements equal to sigma 1, sigma 2,

250
00:30:41,560 --> 00:30:44,879
 and sigma n, sigma m.

251
00:30:44,879 --> 00:30:46,320
 It is like this.

252
00:30:46,320 --> 00:30:48,040
 It's a diagonal matrix.

253
00:30:50,280 --> 00:31:01,280
 OK.

254
00:31:01,280 --> 00:31:04,960
 So these are the elements along the diagonal.

255
00:31:04,960 --> 00:31:07,680
 And the other elements are equal to 0.

256
00:31:11,800 --> 00:31:16,960
 Sigma 1, 2, m are called the singular values.

257
00:31:16,960 --> 00:31:22,080
 They are similar to eigenvalues of matrices.

258
00:31:22,080 --> 00:31:26,840
 If this m, this matrix m is not full rank,

259
00:31:26,840 --> 00:31:33,800
 then some values like sigma i can be equal to 0.

260
00:31:38,280 --> 00:31:43,080
 For non-full rank matrix m, the column of v,

261
00:31:43,080 --> 00:31:45,200
 v is the last matrix.

262
00:31:45,200 --> 00:31:49,240
 The column of v corresponding to 0, single value,

263
00:31:49,240 --> 00:31:53,240
 is in the last space of m.

264
00:31:53,240 --> 00:31:56,200
 Let's say, for example, if we have an equation,

265
00:31:56,200 --> 00:31:59,600
 mx is equal to b.

266
00:31:59,600 --> 00:32:03,080
 We know m, we know b, but we do not know x.

267
00:32:03,080 --> 00:32:06,840
 So here we can solve x out.

268
00:32:06,840 --> 00:32:13,600
 x we have equal to a linear combination of x1, x2, et cetera.

269
00:32:13,600 --> 00:32:19,959
 So c1, x1 plus c2, x2 plus several more terms.

270
00:32:19,959 --> 00:32:25,560
 So this is a linear combination of some vectors.

271
00:32:25,560 --> 00:32:28,320
 And this x1 is x2, et cetera.

272
00:32:28,320 --> 00:32:31,800
 They are called a kernel, but not space of m.

273
00:32:31,800 --> 00:32:47,399
 So from them, we can figure out the solution for x.

274
00:32:47,399 --> 00:32:51,280
 So that's about singular value decomposition.

275
00:32:51,280 --> 00:32:53,360
 In terms of programming, this is very easy.

276
00:32:53,360 --> 00:32:55,280
 You just use one command, SVD.

277
00:32:55,280 --> 00:33:01,720
 So then you can do this SVD for matrix.

278
00:33:01,720 --> 00:33:03,520
 It's a first concept.

279
00:33:03,520 --> 00:33:06,920
 The second is called a school symmetric matrix.

280
00:33:06,920 --> 00:33:09,960
 In this class, we will use this a lot

281
00:33:09,960 --> 00:33:13,720
 in the mathematical derivation.

282
00:33:13,720 --> 00:33:19,880
 School symmetric matrix is actually a 3 by 3 matrix.

283
00:33:19,880 --> 00:33:24,720
 It can be derived from a vector.

284
00:33:24,720 --> 00:33:26,960
 Here we define one vector a.

285
00:33:26,960 --> 00:33:28,080
 a can be any vector.

286
00:33:31,920 --> 00:33:38,520
 It's three-dimensional with three elements a1, a2, a3.

287
00:33:43,680 --> 00:33:46,320
 So based on this vector, we can define a matrix.

288
00:33:50,320 --> 00:33:54,320
 a brackets then cross.

289
00:33:54,320 --> 00:33:56,360
 So this means a matrix.

290
00:33:56,360 --> 00:34:01,440
 It is a 3 by 3 matrix with in total nine elements.

291
00:34:01,440 --> 00:34:05,160
 This matrix looks very special.

292
00:34:05,160 --> 00:34:12,120
 Along the diagonal, all the elements are equal to 0.

293
00:34:12,120 --> 00:34:16,760
 And then for the other six elements,

294
00:34:16,760 --> 00:34:22,600
 they are symmetric along the diagonal,

295
00:34:22,600 --> 00:34:24,159
 but with different signs.

296
00:34:25,000 --> 00:34:29,679
 Here we have negative a3.

297
00:34:29,679 --> 00:34:38,679
 And at the left bottom side, we have a3.

298
00:34:38,679 --> 00:34:41,359
 You can see different signs.

299
00:34:41,359 --> 00:34:44,600
 And for a2, we have negative a2.

300
00:34:44,600 --> 00:34:47,239
 Negative a1, we have a1.

301
00:34:47,239 --> 00:34:48,920
 So these are very special matrix.

302
00:34:48,920 --> 00:34:52,560
 We call it school symmetric matrix.

303
00:34:52,560 --> 00:34:54,400
 And why is this one useful?

304
00:34:54,400 --> 00:35:01,799
 Because it can contain vector calculation

305
00:35:01,799 --> 00:35:11,000
 into a matrix times a vector.

306
00:35:11,000 --> 00:35:13,880
 A cross B, this is a cross product.

307
00:35:13,880 --> 00:35:21,400
 A is a vector.

308
00:35:21,400 --> 00:35:22,520
 B is also a vector.

309
00:35:25,240 --> 00:35:29,480
 If we use this school symmetric matrix, then A cross B,

310
00:35:29,480 --> 00:35:32,600
 it equal to a matrix.

311
00:35:32,600 --> 00:35:41,640
 A cross, this is a matrix times B, which is a vector.

312
00:35:44,120 --> 00:35:54,320
 So this will help to simplify a lot of derivations

313
00:35:54,320 --> 00:35:55,800
 in this class.

314
00:36:02,000 --> 00:36:04,760
 OK, so next I'm going to review with you briefly

315
00:36:04,760 --> 00:36:08,320
 cross product, because we will use this in the mathematical

316
00:36:08,320 --> 00:36:11,320
 derivations a bit later.

317
00:36:11,320 --> 00:36:13,600
 So let me first show you what is a cross product.

318
00:36:20,600 --> 00:36:24,840
 So here we define two vectors, A and B. Both of them

319
00:36:24,840 --> 00:36:27,120
 are three dimensional vectors.

320
00:36:27,120 --> 00:36:28,400
 A is a1, a2, a3.

321
00:36:28,400 --> 00:36:30,520
 B is b1, b2, b3.

322
00:36:37,480 --> 00:36:40,960
 So we first review dot product.

323
00:36:40,960 --> 00:36:49,400
 Two vectors, A dot product B is equal to a1 times b1 plus a2,

324
00:36:49,400 --> 00:36:50,920
 b2 plus a3, b3.

325
00:36:56,000 --> 00:37:00,480
 Cross product is a little bit more complicated.

326
00:37:00,480 --> 00:37:05,360
 So A cross B can be calculated in this way,

327
00:37:05,360 --> 00:37:08,080
 because A and B are both three dimensional.

328
00:37:08,080 --> 00:37:12,840
 So we can write them like this.

329
00:37:12,840 --> 00:37:16,319
 A has three elements, a1, a2, a3.

330
00:37:16,319 --> 00:37:20,880
 Along three directions, I, j, k.

331
00:37:20,880 --> 00:37:25,520
 I, j, k means three different directions.

332
00:37:25,520 --> 00:37:29,680
 And then for B, along the three directions,

333
00:37:29,680 --> 00:37:32,880
 the elements are b1, b2, b3.

334
00:37:32,880 --> 00:37:36,600
 So we can just construct a matrix like this.

335
00:37:36,600 --> 00:37:42,200
 This is A cross B. And then we figure out what this is.

336
00:37:42,200 --> 00:37:45,080
 This is first equal to.

337
00:37:45,080 --> 00:37:48,200
 So we take a look at this i.

338
00:37:48,200 --> 00:37:57,960
 So i times the determinant of this matrix, a2, b2, a3, b3.

339
00:37:57,960 --> 00:38:05,920
 And then minus j times this matrix, a1, b1, a3, b3.

340
00:38:06,799 --> 00:38:12,279
 Then plus k times this matrix, a1, b1, a2, b2.

341
00:38:12,279 --> 00:38:16,160
 So this is the definition of this cross product.

342
00:38:16,160 --> 00:38:19,480
 And from this, we can figure out the three elements

343
00:38:19,480 --> 00:38:24,319
 for the vector A cross B. This looks very complicated.

344
00:38:24,319 --> 00:38:28,520
 So that's why we don't want to have this kind of cross product

345
00:38:28,520 --> 00:38:34,520
 in the mathematical derivation for multi-view geometry.

346
00:38:34,520 --> 00:38:38,880
 If we use this symmetric matrix,

347
00:38:38,880 --> 00:38:42,160
 we can avoid this kind of derivations.

348
00:38:47,080 --> 00:38:51,320
 You can see if we use this A cross, this matrix,

349
00:38:51,320 --> 00:38:54,360
 this cross product becomes very simple.

350
00:38:54,360 --> 00:39:02,320
 It is just a matrix, a symmetric matrix based on A times B.

351
00:39:02,320 --> 00:39:06,920
 So we tan cross product into linear algebra.

352
00:39:06,920 --> 00:39:11,240
 So that's the benefit of using this symmetric matrix.

353
00:40:02,320 --> 00:40:02,820
 OK.

354
00:40:16,040 --> 00:40:18,360
 To introduce this multi-view geometry,

355
00:40:18,360 --> 00:40:20,840
 homography, and intersection matrix,

356
00:40:20,840 --> 00:40:27,760
 we need to define several types of coordinates.

357
00:40:27,760 --> 00:40:33,320
 The pixel coordinates and the euclidean coordinates

358
00:40:33,320 --> 00:40:36,440
 are related using the pinhole camera model.

359
00:40:36,440 --> 00:40:38,680
 So here, we just review this pinhole camera model

360
00:40:38,680 --> 00:40:41,720
 that we covered in last week.

361
00:40:46,360 --> 00:40:51,880
 We first define one feature point on the object.

362
00:40:51,880 --> 00:40:55,360
 So this is an object in a 3D space.

363
00:40:55,360 --> 00:41:00,840
 We define m bar equal to x, y, z transpose.

364
00:41:00,840 --> 00:41:05,400
 This is a three-dimensional vector representing

365
00:41:05,400 --> 00:41:09,720
 this point's coordinates in the 3D space.

366
00:41:09,720 --> 00:41:11,880
 We call it euclidean coordinates.

367
00:41:20,560 --> 00:41:22,600
 So this is the first type of coordinates.

368
00:41:25,360 --> 00:41:25,860
 OK.

369
00:41:33,960 --> 00:41:39,200
 And then we define normalized coordinates.

370
00:41:44,760 --> 00:41:49,760
 So for this x, y, z, we divide all the three elements by z.

371
00:41:49,760 --> 00:41:53,040
 We get x over z, y over z, and one.

372
00:41:53,040 --> 00:41:55,240
 So this is called normalized coordinates.

373
00:41:59,640 --> 00:42:02,200
 So this is the second type of coordinates.

374
00:42:02,200 --> 00:42:02,700
 OK.

375
00:42:18,759 --> 00:42:25,000
 On the images, we can also define pixel coordinates p

376
00:42:25,000 --> 00:42:28,319
 equal to u, v, and 1.

377
00:42:28,320 --> 00:42:33,680
 This is the third type of coordinates, pixel coordinates.

378
00:42:33,680 --> 00:42:37,120
 So from the top to the bottom, we

379
00:42:37,120 --> 00:42:44,800
 have coordinates in a 3D space and then two coordinates

380
00:42:44,800 --> 00:42:48,040
 in the 2D space on the images.

381
00:42:52,400 --> 00:42:56,880
 And these normalized coordinates are kind of between them,

382
00:42:56,880 --> 00:42:59,520
 between the pixel coordinates and the euclidean coordinates.

383
00:43:03,760 --> 00:43:06,800
 And the pixel coordinates are on the image plane.

384
00:43:06,800 --> 00:43:08,120
 We're going to put here.

385
00:43:08,120 --> 00:43:12,080
 Number three, pixel coordinates.

386
00:43:21,720 --> 00:43:26,240
 To connect them together, we can use this p equal to 8

387
00:43:26,240 --> 00:43:29,240
 times m.

388
00:43:29,240 --> 00:43:35,879
 p can be obtained from images using our camera software.

389
00:43:56,240 --> 00:44:06,240
 OK.

390
00:44:06,240 --> 00:44:09,240
 This is measurements.

391
00:44:09,240 --> 00:44:11,399
 This is what we measure using the camera.

392
00:44:20,479 --> 00:44:25,560
 A is a matrix determined only by the camera.

393
00:44:25,560 --> 00:44:30,160
 We call it a camera calibration matrix.

394
00:44:30,160 --> 00:44:34,640
 It can be obtained through camera calibration process.

395
00:44:55,560 --> 00:44:57,799
 OK.

396
00:44:57,799 --> 00:45:03,080
 And then this m is to normalize the coordinates

397
00:45:03,080 --> 00:45:08,720
 with three elements, mx, my, and the 1.

398
00:45:08,720 --> 00:45:21,160
 So to get m from images, we can just

399
00:45:21,160 --> 00:45:25,240
 obtain it from this equation p equal to a times m.

400
00:45:28,000 --> 00:45:30,600
 We move a to the other side.

401
00:45:30,600 --> 00:45:36,480
 What we have is m is equal to the inverse of a times p.

402
00:45:36,480 --> 00:45:38,680
 p can be measured from images.

403
00:45:38,680 --> 00:45:44,879
 And a can be calibrated through the camera calibration process.

404
00:45:44,879 --> 00:45:47,359
 So after we have both a and p, we can figure out

405
00:45:47,360 --> 00:45:51,360
 what m is, the normalized coordinates.

406
00:45:56,360 --> 00:46:02,320
 So this shows how these three types of coordinates are related.

407
00:46:02,320 --> 00:46:03,960
 So for this structure from motion,

408
00:46:03,960 --> 00:46:06,720
 when you want to handle the relative structure,

409
00:46:06,720 --> 00:46:09,600
 when you want to handle rotation and translation,

410
00:46:09,600 --> 00:46:12,760
 we need to use these three types of coordinates.

411
00:46:18,280 --> 00:46:21,880
 OK.

412
00:46:21,880 --> 00:46:26,720
 Some remarks about this pinhole camera model.

413
00:46:26,720 --> 00:46:32,680
 Number one, many estimation and control schemes

414
00:46:32,680 --> 00:46:39,200
 require normalized coordinates for points.

415
00:46:39,200 --> 00:46:43,000
 Nominalized coordinates, as we've done again,

416
00:46:43,000 --> 00:46:50,400
 it's m with three elements, mx, my, and the 1.

417
00:46:50,400 --> 00:47:03,760
 So this coordinates a kind of a bridge, the 2D image space,

418
00:47:03,760 --> 00:47:11,200
 and the 3D, Euclidean space, or the 3D world.

419
00:47:16,600 --> 00:47:22,080
 Giving pixel coordinates p of a point in the image

420
00:47:22,080 --> 00:47:25,160
 and the knowledge of the calibration matrix a,

421
00:47:25,160 --> 00:47:30,840
 we can recover the normalized coordinates using m equal to

422
00:47:30,840 --> 00:47:34,120
 the inverse of a times p.

423
00:47:34,120 --> 00:47:38,320
 Again, this a means the camera calibration matrix.

424
00:47:50,320 --> 00:47:54,120
 And the p means measurements.

425
00:48:01,520 --> 00:48:02,720
 We are a camera sensor.

426
00:48:16,600 --> 00:48:21,440
 Usually there is no way to recover the Euclidean coordinates

427
00:48:21,440 --> 00:48:26,280
 x, y, z without additional information.

428
00:48:26,280 --> 00:48:31,880
 This is because the depth is lost during the imaging process.

429
00:48:31,880 --> 00:48:35,120
 This is called depth ambiguity.

430
00:48:35,120 --> 00:48:38,160
 It's a drawback of the imaging process.

431
00:48:38,160 --> 00:48:44,640
 Usually in robotics, when you're autonomous vehicle research,

432
00:48:44,640 --> 00:48:46,640
 we need to handle this depth ambiguity.

433
00:48:51,400 --> 00:48:53,280
 So let me write it down.

434
00:48:53,280 --> 00:49:07,880
 So in the imaging process from 3D to 2D, the depth information

435
00:49:07,880 --> 00:49:08,560
 is lost.

436
00:49:13,480 --> 00:49:15,960
 And how to find out?

437
00:49:15,960 --> 00:49:17,600
 It is still possible.

438
00:49:17,600 --> 00:49:21,760
 So if we want to figure out what this m bar equal to x, y,

439
00:49:21,760 --> 00:49:29,560
 y is images only are not enough.

440
00:49:29,560 --> 00:49:40,800
 We need either one more sensor or prior knowledge

441
00:49:40,800 --> 00:49:42,760
 of the environment.

442
00:49:51,760 --> 00:49:54,440
 One more image, et cetera.

443
00:50:21,760 --> 00:50:30,600
 OK.

444
00:50:30,600 --> 00:50:36,960
 We use this simple picture to show the idea of post reconstruction.

445
00:50:36,960 --> 00:50:42,520
 And we assume that this building is an object under consideration.

446
00:50:48,440 --> 00:50:51,160
 We use one camera to take two images.

447
00:50:51,160 --> 00:50:56,120
 And this camera can be added to two different poses represented

448
00:50:56,120 --> 00:50:59,759
 by f star and f respectively.

449
00:50:59,759 --> 00:51:04,799
 This f star and f also represent two coordinate frames.

450
00:51:08,480 --> 00:51:11,879
 Two coordinate frames attach to projection center

451
00:51:11,879 --> 00:51:12,640
 of the camera.

452
00:51:21,160 --> 00:51:41,160
 OK.

453
00:51:41,160 --> 00:51:46,879
 Between these two poses, what is two coordinate frames?

454
00:51:52,000 --> 00:51:57,080
 There's a rotation r and a translation x.

455
00:52:01,440 --> 00:52:03,000
 R is a rotation matrix.

456
00:52:03,000 --> 00:52:05,240
 It is used to represent rotation.

457
00:52:06,000 --> 00:52:12,240
 And x is a translation vector.

458
00:52:12,240 --> 00:52:13,560
 It is for translation.

459
00:52:19,799 --> 00:52:22,839
 Given two images of a scene.

460
00:52:22,839 --> 00:52:27,120
 So let's say, for example, here we have two images of the building.

461
00:52:27,120 --> 00:52:31,200
 And the matched corresponding feature points.

462
00:52:31,359 --> 00:52:33,839
 Corresponding feature points.

463
00:52:33,839 --> 00:52:39,240
 For example, for this point on the top of the building.

464
00:52:39,240 --> 00:52:42,560
 So we can find the corresponding points in these two images.

465
00:52:42,560 --> 00:52:47,759
 So they're matched feature points.

466
00:52:47,759 --> 00:52:53,680
 Post reconstruction is about reconstructing the relative position

467
00:52:53,680 --> 00:52:59,279
 and orientation between the two camera poses.

468
00:52:59,280 --> 00:53:07,520
 That is called post reconstruction.

469
00:53:07,520 --> 00:53:14,120
 Post means a six dimensional vector.

470
00:53:20,320 --> 00:53:23,800
 Position plus orientation.

471
00:53:29,600 --> 00:53:34,440
 Post reconstruction can also solve for relative feature

472
00:53:34,440 --> 00:53:40,120
 point coordinates up to a skilled factor.

473
00:53:40,120 --> 00:53:44,720
 It's about relative structure.

474
00:53:59,480 --> 00:54:01,760
 OK.

475
00:54:01,760 --> 00:54:08,720
 From the next slide, we're going to see a lot more mathematics.

476
00:54:08,720 --> 00:54:11,440
 So that's why in the first several slides,

477
00:54:11,440 --> 00:54:16,680
 we were a little bit slow so that you understand what

478
00:54:16,680 --> 00:54:19,600
 those variables mean.

479
00:54:19,600 --> 00:54:25,920
 So once we know the meanings of those variables, r, x, f star,

480
00:54:26,880 --> 00:54:32,240
 and also the straight halves of coordinates,

481
00:54:32,240 --> 00:54:34,400
 normalize coordinate, pixel coordinate,

482
00:54:34,400 --> 00:54:36,760
 and the Euclidean coordinate, then we

483
00:54:36,760 --> 00:54:38,440
 can talk about the multi-view geometry

484
00:54:38,440 --> 00:54:41,760
 and the two different measures, homography

485
00:54:41,760 --> 00:54:42,720
 and essential matrix.

486
00:54:55,920 --> 00:54:56,420
 OK.

487
00:55:05,640 --> 00:55:08,000
 So now we are going to choose one feature point

488
00:55:08,000 --> 00:55:11,640
 on top of the object or the building here.

489
00:55:11,640 --> 00:55:17,040
 And this is one feature point we use auto-represented.

490
00:55:17,040 --> 00:55:31,720
 And two poses, f star and f, we assume that two images are

491
00:55:31,720 --> 00:55:40,800
 taken and they are represented by a point a and a point b,

492
00:55:40,800 --> 00:55:42,040
 respectively.

493
00:55:42,040 --> 00:55:44,880
 These two red dots.

494
00:55:47,400 --> 00:55:50,560
 Between f star and f, r is the rotation, x

495
00:55:50,560 --> 00:55:52,920
 is the translation between them.

496
00:55:56,520 --> 00:55:58,440
 Rotation is a matrix.

497
00:55:58,440 --> 00:56:00,480
 It's r is a matrix.

498
00:56:00,480 --> 00:56:02,560
 It's a 3 by 3 matrix.

499
00:56:03,160 --> 00:56:10,720
 In a very special 3D space, here S L 3

500
00:56:10,720 --> 00:56:13,400
 means a special 3D space.

501
00:56:13,400 --> 00:56:16,760
 S L 3 means a special 3D space.

502
00:56:27,520 --> 00:56:33,720
 Even though r has line elements, but it's not

503
00:56:33,720 --> 00:56:39,320
 in a nine dimensional space, because r has some properties.

504
00:56:40,120 --> 00:56:44,600
 x is a three dimensional vector for translation.

505
00:56:44,600 --> 00:56:50,600
 And here we assume that we have n feature points extracted

506
00:56:50,600 --> 00:56:53,240
 and matched in both images.

507
00:56:53,240 --> 00:56:57,920
 Later on, we'll talk about essential matrix and homography.

508
00:56:57,920 --> 00:57:01,400
 We need eight points and four points respectively.

509
00:57:01,400 --> 00:57:08,000
 So n will be equal to 8 and 4 respectively for the two

510
00:57:08,040 --> 00:57:09,000
 concepts.

511
00:57:11,960 --> 00:57:18,080
 And for this feature point, in f star and f,

512
00:57:18,080 --> 00:57:25,400
 we can define its Euclidean coordinates.

513
00:57:25,400 --> 00:57:30,720
 So in f star, we have mj star bar.

514
00:57:30,720 --> 00:57:34,800
 So this is the coordinate of point o.

515
00:57:34,800 --> 00:57:38,400
 The coordinate of point o in f star.

516
00:57:46,960 --> 00:57:50,120
 O is a feature point.

517
00:57:50,120 --> 00:57:54,400
 And f star, we use it for two different purposes,

518
00:57:54,400 --> 00:58:00,480
 just to reduce the number of concepts.

519
00:58:00,480 --> 00:58:09,440
 So we use f star to define a coordinate frame attached

520
00:58:09,440 --> 00:58:12,040
 to a camera at this pose.

521
00:58:12,040 --> 00:58:19,120
 We also use f star to represent a pose here,

522
00:58:19,120 --> 00:58:24,320
 just to reduce the number of concepts from two to one.

523
00:58:24,320 --> 00:58:26,320
 Otherwise, there are too many concepts

524
00:58:26,320 --> 00:58:29,680
 in this kind of multi-view geometry.

525
00:58:29,680 --> 00:58:33,560
 Mj bar is a coordinate of o in f.

526
00:58:42,359 --> 00:58:46,960
 So far, we have defined just one point and two corner frames

527
00:58:46,960 --> 00:58:50,560
 attached to two camera poses.

528
00:58:50,560 --> 00:58:53,680
 And for these two coordinates, they

529
00:58:53,680 --> 00:58:57,960
 are xj star, yj star, zj star transpose,

530
00:58:57,960 --> 00:59:01,360
 and also xj, yj, zj transpose.

531
00:59:01,360 --> 00:59:05,200
 j means this feature point o.

532
00:59:05,200 --> 00:59:07,240
 Well, the jth point.

533
00:59:07,240 --> 00:59:12,200
 So in total, we have n feature points.

534
00:59:12,200 --> 00:59:15,320
 n is the total number of feature points,

535
00:59:15,320 --> 00:59:23,280
 or just the number of feature points.

536
00:59:23,440 --> 00:59:26,960
 OK.

537
00:59:26,960 --> 00:59:31,200
 Usually, from one image, we can find many feature points.

538
00:59:31,200 --> 00:59:33,040
 But we don't need that many.

539
00:59:33,040 --> 00:59:37,080
 We just need eight points for such a matrix

540
00:59:37,080 --> 00:59:40,200
 and four points for homography.

541
00:59:40,200 --> 00:59:46,040
 For these two coordinates, they are not totally independent.

542
00:59:46,040 --> 00:59:50,560
 They can be linked up by this rotation matrix

543
00:59:50,560 --> 00:59:52,880
 and this translation vector.

544
00:59:52,920 --> 01:00:05,400
 So Mj bar is equal to the rotation matrix R times Mj bar

545
01:00:05,400 --> 01:00:12,480
 star, then plus the translation vector between them plus x.

546
01:00:12,480 --> 01:00:14,080
 OK.

547
01:00:14,080 --> 01:00:20,880
 So this is how these two coordinates are related

548
01:00:20,880 --> 01:00:23,000
 in a 3D space.

549
01:00:23,000 --> 01:00:26,120
 And from this equation, we are going

550
01:00:26,120 --> 01:00:31,680
 to find the essential matrix and the homoctah matrix

551
01:00:31,680 --> 01:00:34,280
 respectively.

552
01:00:34,280 --> 01:00:40,600
 In method one, we have to find the essential matrix

553
01:00:41,600 --> 01:00:44,600
 and we will find the essential matrix.

554
01:00:51,600 --> 01:00:53,600
 And we'll talk about this eight point algorithm.

555
01:01:02,600 --> 01:01:07,600
 And in method two, we'll talk about this homography matrix.

556
01:01:11,600 --> 01:01:16,600
 And the four point algorithm.

557
01:01:28,600 --> 01:01:29,600
 OK.

558
01:01:29,600 --> 01:01:31,600
 Before we take a look at the method matrix,

559
01:01:31,600 --> 01:01:36,600
 let's take a break and we'll start again at 750.

560
01:01:41,600 --> 01:01:44,600
 So meanwhile, if you have questions,

561
01:01:44,600 --> 01:01:46,600
 you can come here and ask me.

562
01:02:10,600 --> 01:02:11,600
 OK.

563
01:02:40,600 --> 01:02:42,600
 OK.

564
01:03:10,600 --> 01:03:12,600
 OK.

565
01:03:40,600 --> 01:03:41,600
 OK.

566
01:04:10,600 --> 01:04:12,600
 OK.

567
01:04:40,600 --> 01:04:41,600
 OK.

568
01:05:10,600 --> 01:05:12,600
 OK.

569
01:05:40,600 --> 01:05:41,600
 OK.

570
01:06:10,600 --> 01:06:12,600
 OK.

571
01:06:40,600 --> 01:06:42,600
 OK.

572
01:07:10,600 --> 01:07:11,600
 OK.

573
01:07:40,600 --> 01:07:41,600
 OK.

574
01:08:10,600 --> 01:08:11,600
 OK.

575
01:08:40,600 --> 01:08:41,600
 OK.

576
01:09:10,600 --> 01:09:11,600
 OK.

577
01:09:40,600 --> 01:09:41,600
 OK.

578
01:10:10,600 --> 01:10:11,600
 OK.

579
01:10:40,600 --> 01:10:41,600
 OK.

580
01:11:10,600 --> 01:11:11,600
 OK.

581
01:11:40,600 --> 01:11:42,600
 OK.

582
01:12:10,600 --> 01:12:12,600
 OK.

583
01:12:40,600 --> 01:12:42,600
 OK.

584
01:13:10,600 --> 01:13:12,600
 OK.

585
01:13:40,600 --> 01:13:42,600
 OK.

586
01:14:10,600 --> 01:14:12,600
 OK.

587
01:14:40,600 --> 01:14:42,600
 OK.

588
01:15:10,600 --> 01:15:12,600
 OK.

589
01:15:40,600 --> 01:15:42,600
 OK.

590
01:16:10,600 --> 01:16:12,600
 OK.

591
01:16:40,600 --> 01:16:42,600
 OK.

592
01:17:10,600 --> 01:17:12,600
 OK.

593
01:17:40,600 --> 01:17:42,600
 OK.

594
01:18:10,600 --> 01:18:12,600
 OK.

595
01:18:40,600 --> 01:19:05,600
 OK.

596
01:19:05,600 --> 01:19:06,600
 OK.

597
01:19:06,600 --> 01:19:13,600
 Let's continue on the class.

598
01:19:13,600 --> 01:19:17,600
 Essential matrix and the eight point algorithm.

599
01:19:17,600 --> 01:19:24,600
 So this is what method one will cover.

600
01:19:24,600 --> 01:19:29,600
 This method has a requirement meaning on the feature points.

601
01:19:29,600 --> 01:19:33,600
 So when we choose eight feature points for this method,

602
01:19:33,600 --> 01:19:36,600
 we cannot choose them arbitrarily.

603
01:19:36,600 --> 01:19:47,600
 So this should be satisfying this condition.

604
01:19:47,600 --> 01:19:57,600
 No four three points are co-planner.

605
01:19:57,600 --> 01:20:04,600
 This means any four points cannot be on the same plane.

606
01:20:28,600 --> 01:20:29,600
 OK.

607
01:20:29,600 --> 01:20:31,600
 So here we have one example.

608
01:20:31,600 --> 01:20:35,600
 In this picture, we have three buildings.

609
01:20:35,600 --> 01:20:43,600
 So from the three buildings, we pick eight feature points.

610
01:20:43,600 --> 01:20:45,600
 So one, two, three.

611
01:20:45,600 --> 01:20:49,600
 These three points are on the same plane.

612
01:20:49,600 --> 01:20:51,600
 And then one, two, three.

613
01:20:51,600 --> 01:20:54,600
 These three are on the same plane.

614
01:20:54,600 --> 01:21:00,600
 But we do not have any four three points on the same plane.

615
01:21:00,600 --> 01:21:07,600
 This is a requirement for the essential matrix method.

616
01:21:07,600 --> 01:21:15,600
 These concepts of essential matrix and this eight point algorithm

617
01:21:15,600 --> 01:21:21,600
 were first published in 1981 in this paper.

618
01:21:21,600 --> 01:21:25,600
 So in a journal, I believe many of you know this journal.

619
01:21:25,600 --> 01:21:28,600
 So it's a top journal.

620
01:21:28,600 --> 01:21:45,600
 So in 1991, this finding was a very big invention.

621
01:21:45,600 --> 01:21:48,600
 Let's take a look at the details.

622
01:21:48,600 --> 01:21:55,600
 Let's say how this essential matrix can be derived and how to find it.

623
01:21:55,600 --> 01:22:07,600
 So we have two questions in mind.

624
01:22:07,600 --> 01:22:11,600
 Two Euclidean coordinates, let's copy them here.

625
01:22:11,600 --> 01:22:23,600
 Mj bar star and Mj bar.

626
01:22:23,600 --> 01:22:36,600
 So they are the coordinates of the same feature point in f star and f respectively.

627
01:22:36,600 --> 01:22:53,600
 From these two Euclidean coordinates, we can find out the normalized coordinates.

628
01:22:53,600 --> 01:22:57,600
 Mj star and Mj respectively.

629
01:22:57,600 --> 01:23:13,600
 Mj star is defined as Mj star bar divided by the z component, zj star.

630
01:23:13,600 --> 01:23:16,600
 So then we get this normalized coordinate.

631
01:23:16,600 --> 01:23:34,600
 Similarly, this Mj comes from Mj bar divided by zj.

632
01:23:34,600 --> 01:23:47,600
 On slide 12, we have one equation that links up these two Euclidean coordinates.

633
01:23:47,600 --> 01:23:59,600
 So here we just copy them and then use it as a foundation for the subsequent development.

634
01:23:59,600 --> 01:24:01,600
 So we copy that equation here.

635
01:24:01,600 --> 01:24:16,600
 Mj bar equal to rotation matrix r times Mj bar star and plus transnational vector x.

636
01:24:16,600 --> 01:24:36,600
 In the first step of derivation, we just rewrite this Mj bar into zj times Mj.

637
01:24:36,600 --> 01:24:48,600
 On the right hand side, we can rewrite Mj bar star into zj star times this Mj star.

638
01:24:48,600 --> 01:24:55,600
 So it's just like a rewriting of this equation.

639
01:24:55,600 --> 01:25:08,600
 Next, we're going to multiply one matrix to both sides of this equation.

640
01:25:08,600 --> 01:25:25,600
 And we'll multiply this symmetric matrix x cross to both sides of this equation.

641
01:25:25,600 --> 01:25:31,600
 Let's give it a name to make it easier to recall.

642
01:25:31,600 --> 01:25:33,600
 So it's equation star.

643
01:25:33,600 --> 01:25:36,600
 Just give it a name.

644
01:25:36,600 --> 01:25:44,600
 So of this equation, star.

645
01:25:44,600 --> 01:25:50,600
 For the three terms, we're going to multiply this x cross.

646
01:25:50,600 --> 01:25:55,600
 And for the last term, let's have the easiest term first.

647
01:25:55,600 --> 01:26:02,600
 For this x, let's say what is x cross times x?

648
01:26:03,600 --> 01:26:16,600
 x cross times x is equal to, based on the definition, this means a cross product between x and x.

649
01:26:16,600 --> 01:26:22,600
 So it's x cross x, this is equal to 0.

650
01:26:22,600 --> 01:26:33,600
 Cross product of two equal vectors is always equal to 0.

651
01:26:33,600 --> 01:26:36,600
 So the last term is gone.

652
01:26:36,600 --> 01:26:39,600
 So here, let's write it down.

653
01:26:39,600 --> 01:26:46,600
 We have x cross times x.

654
01:26:46,600 --> 01:26:50,600
 This term is actually equal to 0.

655
01:26:50,600 --> 01:26:52,600
 So it disappears.

656
01:26:52,600 --> 01:26:56,600
 Then we have two terms.

657
01:26:56,600 --> 01:27:02,600
 Let's handle them one by one.

658
01:27:02,600 --> 01:27:14,600
 For the left-hand side, we will get...

659
01:27:14,600 --> 01:27:16,600
 This is what we have already.

660
01:27:16,600 --> 01:27:18,600
 We're going to write equation.

661
01:27:18,600 --> 01:27:34,600
 And next, we're going to multiply Mj transpose to both sides of this equation.

662
01:27:34,600 --> 01:27:37,600
 Then we'll take a look at the left-hand side.

663
01:27:37,600 --> 01:27:49,600
 This should be equal to Zj times Mj transpose.

664
01:27:49,600 --> 01:27:57,600
 Then for the rest, we just copy x cross Mj.

665
01:27:57,600 --> 01:28:01,600
 So that's the left-hand side.

666
01:28:01,600 --> 01:28:04,600
 And this should be equal to the right-hand side.

667
01:28:04,600 --> 01:28:11,600
 We have Zj star times...

668
01:28:11,600 --> 01:28:20,600
 It's a vector, Mj transpose, in terms of the next three terms.

669
01:28:20,600 --> 01:28:27,600
 X cross R Mj star.

670
01:28:27,600 --> 01:28:31,600
 So left-hand side is equal to right-hand side.

671
01:28:31,600 --> 01:28:38,600
 Now we're going to show that the left-hand side is equal to 0.

672
01:28:38,600 --> 01:28:40,600
 This is equal to 0.

673
01:28:40,600 --> 01:28:47,600
 Let's see why this term is equal to 0.

674
01:28:57,600 --> 01:29:03,600
 Because Zj is a scanner, so we don't have to worry about it.

675
01:29:03,600 --> 01:29:16,600
 Then for this Mj transpose times x cross Mj.

676
01:29:16,600 --> 01:29:22,600
 This is just equal to Mj.

677
01:29:22,600 --> 01:29:26,600
 Mj is a vector, a three-dimensional vector.

678
01:29:26,600 --> 01:29:35,600
 Dot product x cross times Mj.

679
01:29:35,600 --> 01:29:49,600
 And this is further equal to Mj dot product x cross product of Mj.

680
01:29:49,600 --> 01:29:55,600
 And this is always equal to 0.

681
01:29:55,600 --> 01:30:01,600
 Because we have this Mj appear twice in this equation.

682
01:30:01,600 --> 01:30:12,600
 Let's say this from this simple schematic.

683
01:30:12,600 --> 01:30:23,600
 We can define this vector x and the vector Mj.

684
01:30:23,600 --> 01:30:28,600
 So there are two three-dimensional vectors.

685
01:30:28,600 --> 01:30:32,600
 The first thing I want to do is x cross Mj.

686
01:30:32,600 --> 01:30:40,600
 It is a vector perpendicular to both x and Mj.

687
01:30:40,600 --> 01:30:47,600
 90 degrees and also here, also 90 degrees.

688
01:30:47,600 --> 01:30:56,600
 And this vector in blue is x cross Mj.

689
01:30:56,600 --> 01:31:08,600
 For this Mj and this cross product, the angle between these two vectors is 90 degrees.

690
01:31:08,600 --> 01:31:14,600
 So this dot product is always equal to 0.

691
01:31:14,600 --> 01:31:30,600
 So I have proved that the left-hand side is always equal to 0.

692
01:31:30,600 --> 01:31:44,600
 Because of this, the right-hand side should also be equal to 0.

693
01:31:44,600 --> 01:31:50,600
 So we just copy what is in the right-hand side.

694
01:31:50,600 --> 01:32:09,600
 This is a J transpose times, Zj star times Mj transpose times x cross R Mj star.

695
01:32:09,600 --> 01:32:11,600
 This is equal to 0.

696
01:32:12,600 --> 01:32:24,600
 On this slide, even though we have a lot of mathematics, they are all linear algebra.

697
01:32:24,600 --> 01:32:33,600
 And also, this is the kind of the main invention for that nature paper.

698
01:32:33,600 --> 01:32:36,600
 So now you can see this looks very easy to us.

699
01:32:36,600 --> 01:32:40,600
 So after we know the details, this looks very simple.

700
01:32:40,600 --> 01:32:45,600
 But it was not easy to discover this.

701
01:32:45,600 --> 01:32:59,600
 So you have to try many different methods and many mathematics until you reach this point.

702
01:32:59,600 --> 01:33:07,600
 So let's spend about 30 seconds just going through these mathematics and digesting a little bit.

703
01:33:07,600 --> 01:33:10,600
 And we can move to the next slide.

704
01:33:10,600 --> 01:33:19,600
 And this is kind of the core or the key point of this concept, the essential matrix.

705
01:33:19,600 --> 01:33:24,600
 It is required for this class how to derive it. This is required.

706
01:33:24,600 --> 01:33:51,600
 This is the key equation for this slide.

707
01:33:52,600 --> 01:34:03,600
 Zj star times Mj transpose times x cross is matrix and times R times Mj star equal to 0.

708
01:34:03,600 --> 01:34:05,600
 What does J mean here?

709
01:34:05,600 --> 01:34:10,600
 J means a feature point, the J's feature point.

710
01:34:10,600 --> 01:34:20,600
 And we will see this equation on the next slide.

711
01:34:20,600 --> 01:34:32,600
 This equation is, in this equation we have this term equal to 0.

712
01:34:32,600 --> 01:34:39,600
 So this is valid not just for one feature point.

713
01:34:39,600 --> 01:34:49,600
 It's valid actually for all the matching feature points under two images.

714
01:34:49,600 --> 01:34:59,600
 This equation is also called essential constraint or epipolar constraint.

715
01:34:59,600 --> 01:35:08,600
 So if you read some robotics paper for robotic motion control, you may notice this concept.

716
01:35:08,600 --> 01:35:22,600
 According to essential matrix, sorry, according to essential constraint or according to epipolar constraint, it actually refers to this.

717
01:35:22,600 --> 01:35:29,600
 The matrix E which is x cross times R.

718
01:35:29,600 --> 01:35:38,600
 So this matrix, this is called the essential matrix.

719
01:35:38,600 --> 01:35:44,600
 It contains the relative pose information.

720
01:35:45,600 --> 01:35:51,600
 So just from this simple definition, we can see that E has x inside.

721
01:35:51,600 --> 01:35:53,600
 E also had R inside.

722
01:35:53,600 --> 01:35:59,600
 So kind of this matrix covers both rotation and translation.

723
01:35:59,600 --> 01:36:04,600
 They're coupled or combined.

724
01:36:04,600 --> 01:36:07,600
 So that's the definition of essential matrix.

725
01:36:07,600 --> 01:36:09,600
 And how to find it?

726
01:36:09,600 --> 01:36:12,600
 Then we should use the A point algorithm.

727
01:36:12,600 --> 01:36:23,600
 So if we have eight feature points without four of them on the same plane, then we can calculate this essential matrix E.

728
01:36:42,600 --> 01:37:01,600
 And here I want to mention one more thing is that in the definition of this essential matrix E, we don't have any feature point.

729
01:37:01,600 --> 01:37:04,600
 We don't have J there.

730
01:37:04,600 --> 01:37:07,600
 So J means the J's feature point.

731
01:37:07,600 --> 01:37:18,600
 This equation depends on the feature point, but this essential matrix is independent of the feature point.

732
01:37:18,600 --> 01:37:24,600
 So no matter which point you use, you always have this, the same essential matrix.

733
01:37:24,600 --> 01:37:30,600
 So it is invariant of feature points or independent of feature points.

734
01:37:30,600 --> 01:37:33,600
 That's why this concept is useful.

735
01:37:38,600 --> 01:37:40,600
 How to find it?

736
01:37:40,600 --> 01:37:51,600
 If eight or more feature points are available, this E can be estimated using linear algebra method.

737
01:37:51,600 --> 01:37:56,600
 It is called A point algorithm.

738
01:37:58,600 --> 01:38:02,600
 Let's see some details on how to get it.

739
01:38:03,600 --> 01:38:05,600
 E is a matrix.

740
01:38:05,600 --> 01:38:08,600
 It is a three by three matrix.

741
01:38:08,600 --> 01:38:11,600
 So in total, E has nine elements.

742
01:38:11,600 --> 01:38:18,600
 E1, E2, E3, E4, 5, 6, and E7, E8, 9.

743
01:38:18,600 --> 01:38:20,600
 Nine elements.

744
01:38:20,600 --> 01:38:24,600
 So now we're going to re-organize this matrix a little bit.

745
01:38:24,600 --> 01:38:28,600
 We will use the nine elements to define a vector.

746
01:38:28,600 --> 01:38:30,600
 Lowercase E.

747
01:38:30,600 --> 01:38:38,600
 It is a common vector with nine elements from E1, E2, and E9.

748
01:38:38,600 --> 01:38:40,600
 So they are the same thing.

749
01:38:40,600 --> 01:38:42,600
 Matrix and a vector.

750
01:38:42,600 --> 01:38:47,600
 They contain the same amount of information.

751
01:38:47,600 --> 01:38:55,600
 To calculate it, we will use the normalized coordinates, Mg and Mg star.

752
01:38:58,600 --> 01:39:13,600
 Mg is equal to Mx, My1, and transpose.

753
01:39:13,600 --> 01:39:17,600
 So this is defined in the corner frame F.

754
01:39:17,600 --> 01:39:22,600
 Mg star has three elements.

755
01:39:22,600 --> 01:39:29,600
 Mx star, My star, and 1.

756
01:39:29,600 --> 01:39:36,600
 It is in the corner frame F star.

757
01:39:36,600 --> 01:39:41,600
 So based on this pair of normalized coordinates,

758
01:39:41,600 --> 01:39:47,600
 we can define a row vector, capital Mg.

759
01:39:47,600 --> 01:39:53,600
 So we just use Mx, My, Mx star, My star to define a vector.

760
01:39:53,600 --> 01:39:56,600
 Mg is equal to this.

761
01:39:56,600 --> 01:40:11,600
 It has in total nine elements.

762
01:40:11,600 --> 01:40:15,600
 So the last three is Mx, My1.

763
01:40:15,600 --> 01:40:21,600
 And then for the first three elements, they define that base.

764
01:40:21,600 --> 01:40:25,600
 Mx star times something.

765
01:40:25,600 --> 01:40:29,600
 Times Mx times My times 1.

766
01:40:29,600 --> 01:40:34,600
 And then for the next three elements, they start with My star.

767
01:40:34,600 --> 01:40:37,600
 My star times something.

768
01:40:37,600 --> 01:40:42,600
 Times Mx times My times 1.

769
01:40:42,600 --> 01:40:46,600
 Then for the next three elements, it's just Mx, My and 1.

770
01:40:46,600 --> 01:41:03,600
 So this is the kind of the pattern in the definition of this vector Mg.

771
01:41:03,600 --> 01:41:08,600
 Then based on this Mg, we can get one equation for this epipolar constraint,

772
01:41:08,600 --> 01:41:12,600
 which is Mg times E is equal to 0,

773
01:41:12,600 --> 01:41:18,600
 which means this vector times this vector is equal to 0.

774
01:41:18,600 --> 01:41:27,600
 This can also be obtained from slide 15.

775
01:41:27,600 --> 01:41:38,600
 From this equation, Mg transpose times E times Mg transpose equal to 0.

776
01:41:38,600 --> 01:41:42,600
 So we can get this Mg times E equals 0.

777
01:41:42,600 --> 01:41:56,600
 These are for one feature point, J.

778
01:41:56,600 --> 01:42:03,600
 And J is in this set, 1, 2, and here capital N.

779
01:42:03,600 --> 01:42:06,600
 So in total, we have N feature points.

780
01:42:06,600 --> 01:42:08,600
 J is just one of them.

781
01:42:08,600 --> 01:42:12,600
 From one feature point, we can get one equation.

782
01:42:12,600 --> 01:42:15,600
 From 10 points, we can get 10 equations.

783
01:42:15,600 --> 01:42:18,600
 So here we have N points.

784
01:42:18,600 --> 01:42:22,600
 So we can have N equations.

785
01:42:22,600 --> 01:42:25,600
 M1 times E equals 0.

786
01:42:25,600 --> 01:42:27,600
 M2 times E equals 0.

787
01:42:27,600 --> 01:42:34,600
 Here M1, M2 are both vectors, nine dimensional vectors.

788
01:42:34,600 --> 01:42:40,600
 And two, MN times E equals 0.

789
01:42:40,600 --> 01:42:45,600
 So next, we're going to combine these N equations.

790
01:42:45,600 --> 01:42:50,600
 We will have a big matrix.

791
01:42:50,600 --> 01:42:57,600
 M1, M2, MN times E equals 0.

792
01:42:57,600 --> 01:43:02,600
 So first matrix, we use M to represent it.

793
01:43:02,600 --> 01:43:04,600
 It has N rows.

794
01:43:04,600 --> 01:43:11,600
 The first row is M1, determined by the feature point 1.

795
01:43:11,600 --> 01:43:16,600
 The second row M2 is determined by the second feature point number 2.

796
01:43:16,600 --> 01:43:29,600
 So similarly, the last row is determined by the N's feature point.

797
01:43:29,600 --> 01:43:37,600
 So that's how we can get a number of equations to solve E1, E2, E3,

798
01:43:37,600 --> 01:43:45,600
 and E9 to solve the essential matrix.

799
01:43:45,600 --> 01:43:49,600
 This is called the eight point algorithm.

800
01:43:59,600 --> 01:44:22,600
 OK.

801
01:44:22,600 --> 01:44:28,600
 So just now from the feature points, we got the equation M1 equal to 0.

802
01:44:28,600 --> 01:44:37,600
 So from this equation, we can find what E is.

803
01:44:37,600 --> 01:44:44,600
 Let's assume that we already find a solution E.

804
01:44:44,600 --> 01:44:50,600
 If E is a solution, which means M1 is equal to 0.

805
01:44:50,600 --> 01:44:57,600
 So if this is satisfied, what if we have a constant C to E?

806
01:44:57,600 --> 01:45:01,600
 So now we'll have C times E. This will also be a solution,

807
01:45:01,600 --> 01:45:12,600
 because if ME is 0, the M times CE is equal to C times ME.

808
01:45:12,600 --> 01:45:14,600
 This is also equal to 0.

809
01:45:14,600 --> 01:45:20,600
 Here C is a constant.

810
01:45:20,600 --> 01:45:25,600
 This means that if E is a solution, then for any constant,

811
01:45:25,600 --> 01:45:27,600
 we can find another solution.

812
01:45:27,600 --> 01:45:35,600
 So this means that the solution is not unique.

813
01:45:35,600 --> 01:45:51,600
 So this means that this essential matrix E will only be estimated up to a scale factor.

814
01:45:51,600 --> 01:46:00,600
 So this is the meaning.

815
01:46:00,600 --> 01:46:06,600
 How to decompose E to find rotation and translation?

816
01:46:06,600 --> 01:46:25,600
 This part is shown in the next several slides.

817
01:46:25,600 --> 01:46:27,600
 I'll just talk about the main idea.

818
01:46:27,600 --> 01:46:30,600
 For some details, it's not required for this class,

819
01:46:30,600 --> 01:46:34,600
 because it is too complicated and also very long.

820
01:46:34,600 --> 01:46:40,600
 And I will naturally note that which part is for reference reading only.

821
01:46:40,600 --> 01:46:46,600
 That means if it's for reference reading, then we are not tested in the quiz

822
01:46:46,600 --> 01:47:01,600
 and also not tested in the final exam.

823
01:47:01,600 --> 01:47:11,600
 So this E is ideally X cross times R without noise and calibration errors.

824
01:47:11,600 --> 01:47:16,600
 So we can estimate this E.

825
01:47:16,600 --> 01:47:21,600
 What if we have noise and we have some errors in the camera calibration?

826
01:47:21,600 --> 01:47:28,600
 Then for the E that you calculated, it is not ideal.

827
01:47:28,600 --> 01:47:36,600
 So ideal E, if we do SVD, single-valid decomposition,

828
01:47:36,600 --> 01:47:57,600
 we will get this diagonal matrix, sigma, equal to either 110 or negative 1, negative 1, 0.

829
01:47:58,600 --> 01:48:01,600
 This is from the single-valid decomposition.

830
01:48:01,600 --> 01:48:05,600
 If there is noise, then this sigma will be a little bit different.

831
01:48:05,600 --> 01:48:13,600
 Let me show you one example.

832
01:48:13,600 --> 01:48:28,600
 This sigma may be equal to 0.85, 0.95, and 0.05.

833
01:48:28,600 --> 01:48:35,600
 So this 0 can be a very small number and a 1 can be a number close to 1, but not equal to 1.

834
01:48:35,600 --> 01:48:42,600
 So this is due to the noise in the images or due to the camera calibration errors.

835
01:48:42,600 --> 01:48:54,600
 So in practice, noise and the calibration errors cannot be avoided.

836
01:48:54,600 --> 01:49:01,600
 If this happens, then we have to do a correction.

837
01:49:01,600 --> 01:49:09,600
 The last three items are for the correction.

838
01:49:09,600 --> 01:49:18,600
 So how do we fix the result if there are minor errors there or if there is a little bit of noise there?

839
01:49:18,600 --> 01:49:23,600
 When the errors and the noises are too big, then this does not work.

840
01:49:23,600 --> 01:49:29,600
 If there is too much noise, then your images have very bad quality.

841
01:49:29,600 --> 01:49:32,600
 So we need to improve the quality of the images.

842
01:49:33,600 --> 01:49:41,600
 If the calibration error is too big, then we have to redo the calibration.

843
01:49:41,600 --> 01:49:49,600
 If the noise is not that much and if the error is smaller, then we can use this correction.

844
01:49:49,600 --> 01:49:57,600
 We can project our estimate of E to the closest to the true essential matrix.

845
01:49:57,600 --> 01:50:06,600
 Next example, if this sigma is in the next phase, the first two numbers are still quite close to 1,

846
01:50:06,600 --> 01:50:10,600
 and the last number is still quite close to 0.

847
01:50:10,600 --> 01:50:12,600
 Then we can do calibration.

848
01:50:12,600 --> 01:50:23,600
 We can replace this matrix sigma with diagonal 110.

849
01:50:23,600 --> 01:50:26,600
 This is a diagonal matrix.

850
01:50:26,600 --> 01:50:31,600
 This is the correction with respect to noise and the calibration errors.

851
01:50:31,600 --> 01:51:00,600
 So for what we just described, this contains

852
01:51:01,600 --> 01:51:06,600
 a many practical implementations.

853
01:51:06,600 --> 01:51:29,600
 Why do I want to do this SVD single value decomposition?

854
01:51:29,600 --> 01:51:40,600
 Because we want to find rotation R and translation from this matrix E.

855
01:51:40,600 --> 01:51:48,600
 And on the next slide for the details, we leave it for reference rating only.

856
01:52:11,600 --> 01:52:22,600
 I will still talk about it briefly so that you understand the main idea of this decomposition.

857
01:52:23,600 --> 01:52:38,600
 After we estimate this essential matrix E, we want to decompose it and figure out rotation and translation.

858
01:52:39,600 --> 01:52:49,600
 Why do I want to do this?

859
01:52:49,600 --> 01:52:58,600
 Because when we control the motion of a robot, we handle the rotational motion and the translational motion.

860
01:52:59,600 --> 01:53:07,600
 We need these two vectors. We need the vector X and the matrix R.

861
01:53:07,600 --> 01:53:13,600
 To decompose it, we start from this very special rotation matrix.

862
01:53:13,600 --> 01:53:16,600
 In this class, we don't talk about the exact details.

863
01:53:16,600 --> 01:53:23,600
 First, we define a simple base matrix like this.

864
01:53:23,600 --> 01:53:29,600
 Very special with rotation of 90 degrees or negative 90 degrees.

865
01:53:29,600 --> 01:53:42,600
 And from this matrix, RZ, we can use SVD to find the translation vector.

866
01:53:43,600 --> 01:53:51,600
 X prime. X prime means a skilled translation.

867
01:53:51,600 --> 01:54:03,600
 X prime is equal to a constant lambda times the real rotation vector.

868
01:54:04,600 --> 01:54:15,600
 Here X means the real translation vector.

869
01:54:15,600 --> 01:54:22,600
 And here lambda means a skilled vector.

870
01:54:22,600 --> 01:54:28,600
 It's just a positive number or a positive constant.

871
01:54:28,600 --> 01:54:48,600
 X prime means the skilled translation with a skilled vector.

872
01:54:48,600 --> 01:54:57,600
 It is not exactly the translation, but it is proportional to the translation.

873
01:54:57,600 --> 01:55:03,600
 This is for reference reading. Not required.

874
01:55:14,600 --> 01:55:21,600
 For the solution from the essential matrix, it is not unique.

875
01:55:21,600 --> 01:55:26,600
 If M transpose times E times M star is equal to 0.

876
01:55:26,600 --> 01:55:35,600
 If this is true, then M transpose times negative E times M star.

877
01:55:35,600 --> 01:55:38,600
 This is also true.

878
01:55:38,600 --> 01:55:45,600
 So that means if E is a solution, then minus E is also a solution.

879
01:55:45,600 --> 01:55:49,600
 This is similar to slide 18.

880
01:55:57,600 --> 01:56:02,600
 From this, we will have two more solutions.

881
01:56:10,600 --> 01:56:18,600
 In total, we may have four possible solutions for the post.

882
01:56:27,600 --> 01:56:32,600
 This is what we get mathematically.

883
01:56:32,600 --> 01:56:37,600
 But physically, there should be only one solution.

884
01:56:39,600 --> 01:56:46,600
 Three solutions will be physically impossible.

885
01:56:46,600 --> 01:56:53,600
 As they will require at least some feature points to be behind the camera.

886
01:56:53,600 --> 01:56:58,600
 So mathematically, the feature points can be anywhere.

887
01:56:58,600 --> 01:57:10,600
 But in practice, the feature points should be in front of the camera, but not behind the camera.

888
01:57:10,600 --> 01:57:16,600
 So by using this constraint, we can remove some solutions.

889
01:57:17,600 --> 01:57:26,600
 Also from this constraint, the number is positive and the number of stars is also positive.

890
01:57:30,600 --> 01:57:38,600
 So that is the constraint that we can use to remove impossible solutions.

891
01:57:39,600 --> 01:57:49,600
 For the structure from motion, as we mentioned earlier, there are two different objectives.

892
01:57:49,600 --> 01:57:52,600
 The number one is to find the rotation and the translation.

893
01:57:52,600 --> 01:57:55,600
 The second one is to find the relative structure.

894
01:57:55,600 --> 01:57:59,600
 Next, we will talk a little bit about this relative structure.

895
01:58:08,600 --> 01:58:16,600
 What does this mean?

896
01:58:16,600 --> 01:58:19,600
 Let me show you one simple example.

897
01:58:19,600 --> 01:58:22,600
 In this classroom, there are so many students.

898
01:58:22,600 --> 01:58:28,600
 Some of you are closer to me, some of you are quite far away from me.

899
01:58:28,600 --> 01:58:35,600
 For example, I am sitting at the back of the classroom, so you are further away.

900
01:58:36,600 --> 01:58:46,600
 Relative structure information means something that can roughly describe where you are.

901
01:58:46,600 --> 01:58:50,600
 So you will have a relative structure in motion.

902
01:58:50,600 --> 01:58:58,600
 We can support this structure building or 3D reconstruction.

903
01:58:58,600 --> 01:59:05,600
 How to do it?

904
01:59:05,600 --> 01:59:14,600
 We start from the equation, lambda mj equals lambda star times this.

905
01:59:14,600 --> 01:59:20,600
 This equation just comes from mj bar.

906
01:59:20,600 --> 01:59:27,600
 Let me copy that equation here.

907
01:59:34,600 --> 01:59:45,600
 r times mj star bar plus x.

908
01:59:46,600 --> 01:59:57,600
 On both sides of this equation, we are going to multiply mj cross,

909
01:59:57,600 --> 02:00:01,600
 which is a 3 by 3 matrix.

910
02:00:01,600 --> 02:00:09,600
 After we do this, the left-hand side becomes 0.

911
02:00:09,600 --> 02:00:15,600
 This is from the left-hand side.

912
02:00:15,600 --> 02:00:26,600
 This is equal to lambda times mj cross times mj.

913
02:00:26,600 --> 02:00:30,600
 This is always equal to 0.

914
02:00:30,600 --> 02:00:42,600
 The right-hand side becomes the 2 terms in the second equation.

915
02:00:42,600 --> 02:00:46,600
 The sum is equal to 0.

916
02:00:46,600 --> 02:00:50,600
 We are going to rewrite the first two terms a little bit.

917
02:00:50,600 --> 02:00:57,600
 We will write them into the vector matrix form for this lambda j.

918
02:00:57,600 --> 02:01:04,600
 The first term is lambda j star.

919
02:01:04,600 --> 02:01:08,600
 The second term is this times 1.

920
02:01:08,600 --> 02:01:12,600
 We are going to rewrite it.

921
02:01:12,600 --> 02:01:23,600
 This term and also this term, we take them out and put them into this matrix.

922
02:01:23,600 --> 02:01:26,600
 Here is actually a vector.

923
02:01:26,600 --> 02:01:30,600
 It is a real vector.

924
02:01:30,600 --> 02:01:39,600
 For this lambda j star and the 1, we put it into a column vector like this.

925
02:01:39,600 --> 02:01:48,600
 This second equation can be written into the vector matrix form like this.

926
02:01:48,600 --> 02:01:58,600
 This is for the free-to-point j.

927
02:01:58,600 --> 02:02:01,600
 For one point.

928
02:02:01,600 --> 02:02:05,600
 Since we have n-point, n-free-to-point,

929
02:02:05,600 --> 02:02:09,600
 we are going to get n equations.

930
02:02:09,600 --> 02:02:11,600
 We can combine them together.

931
02:02:11,600 --> 02:02:14,600
 We have something like this.

932
02:02:14,600 --> 02:02:21,600
 If we solve this equation, we can figure out lambda star.

933
02:02:21,600 --> 02:02:37,600
 Namda star means a vector consisting of lambda 1 star, lambda 2 star, and 2 lambda n star.

934
02:02:37,600 --> 02:02:56,600
 If we can have this vector, they will have the relative structure information.

935
02:02:56,600 --> 02:03:00,600
 Post reconstruction is more complicated than this.

936
02:03:00,600 --> 02:03:10,600
 This shows us some basic idea of what post reconstruction means.

937
02:03:10,600 --> 02:03:13,600
 Next, we can take a look at one example.

938
02:03:13,600 --> 02:03:18,600
 From two images, how can we find rotation,

939
02:03:18,600 --> 02:03:34,600
 secure translation, and also this relative structure information, lambda star?

940
02:03:34,600 --> 02:03:42,600
 In this example, we have two images.

941
02:03:42,600 --> 02:03:53,600
 You can see the first two images are almost the same, but just taken at different poses.

942
02:03:53,600 --> 02:03:57,600
 On the image, we can find several planes.

943
02:03:57,600 --> 02:04:03,600
 For this computer monitor, there is one plane.

944
02:04:03,600 --> 02:04:09,600
 Here, we pick three feature points.

945
02:04:09,600 --> 02:04:17,600
 The feature points are represented using some green stars, which are not very big.

946
02:04:17,600 --> 02:04:20,600
 I am going to circle them.

947
02:04:20,600 --> 02:04:25,600
 This is one at a corner, one, two, three.

948
02:04:25,600 --> 02:04:29,600
 There are three green stars over there.

949
02:04:29,600 --> 02:04:32,600
 They are for three feature points.

950
02:04:32,600 --> 02:04:39,600
 On the photo frame, there are three feature points.

951
02:04:39,600 --> 02:04:44,600
 One, two, and three.

952
02:04:44,600 --> 02:04:49,600
 On the speaker, there are two feature points.

953
02:04:49,600 --> 02:04:55,600
 In total, we have nine feature points.

954
02:04:55,600 --> 02:05:03,600
 This experiment was done by one of my paper collaborators.

955
02:05:03,600 --> 02:05:08,600
 These two images were taken by him.

956
02:05:08,600 --> 02:05:14,600
 He did all the programming and got the results.

957
02:05:14,600 --> 02:05:18,600
 This image is taken at f star.

958
02:05:18,600 --> 02:05:24,600
 We have another image taken at frame f.

959
02:05:24,600 --> 02:05:26,600
 We have two images.

960
02:05:26,600 --> 02:05:41,600
 Between f star and f, we assume that there is a rotation r and a translation x between them, from f star to f.

961
02:05:41,600 --> 02:05:51,600
 Just now, we actually selected eight feature points.

962
02:05:51,600 --> 02:06:03,600
 We don't have any four of them.

963
02:06:03,600 --> 02:06:06,600
 We have four co-planned them.

964
02:06:06,600 --> 02:06:13,600
 We have four on the same plane.

965
02:06:13,600 --> 02:06:17,600
 Just now, we selected these eight feature points.

966
02:06:17,600 --> 02:06:21,600
 We selected them from three different planes.

967
02:06:21,600 --> 02:06:27,600
 We don't have any four of them on the same plane.

968
02:06:27,600 --> 02:06:30,600
 This is about feature point selection.

969
02:06:30,600 --> 02:06:42,600
 We do this just to make sure that the condition to use the user matrix is satisfied.

970
02:06:42,600 --> 02:06:57,600
 If we have four feature points on the same plane, then this method does not work.

971
02:06:57,600 --> 02:07:09,600
 After we choose the eight feature points, we can figure out the essential matrix.

972
02:07:09,600 --> 02:07:15,600
 The essential matrix is E.

973
02:07:15,600 --> 02:07:19,600
 We decompose it using SVD.

974
02:07:19,600 --> 02:07:35,600
 We can get four solutions.

975
02:07:35,600 --> 02:07:43,600
 Actually, for these four solutions, it is more accurate to call them four possible solutions.

976
02:07:43,600 --> 02:07:45,600
 Because three of them will be wrong.

977
02:07:45,600 --> 02:07:49,600
 Only one solution is correct.

978
02:07:49,600 --> 02:07:55,600
 The first column is for the scale of the translation vector x prime.

979
02:07:55,600 --> 02:08:06,600
 The second column is for the rotation matrix r.

980
02:08:06,600 --> 02:08:09,600
 How to decide which solution is correct?

981
02:08:09,600 --> 02:08:18,600
 We will use the positive depth constraint.

982
02:08:18,600 --> 02:08:24,600
 Namda and Namda star should both be positive.

983
02:08:24,600 --> 02:08:33,600
 For both of the four solutions, we can find out that for the first solution, the depth is positive.

984
02:08:33,600 --> 02:08:35,600
 This is fine.

985
02:08:35,600 --> 02:08:39,600
 The last one is also positive.

986
02:08:39,600 --> 02:08:45,600
 For solutions two and three, we have negative depth information.

987
02:08:45,600 --> 02:08:49,600
 They can be removed.

988
02:08:49,600 --> 02:09:07,600
 We can remove two solutions using the depth constraint.

989
02:09:07,600 --> 02:09:22,600
 Next, we will use the relative depth to remove one more solution.

990
02:09:22,600 --> 02:09:26,600
 For relative depth, it is Namda star.

991
02:09:26,600 --> 02:09:34,600
 As we defined just now, it is a vector consisting of Namda 1 star from the first feature point.

992
02:09:34,600 --> 02:09:41,600
 Namda 2 star from feature point 2 until Namda n star.

993
02:09:41,600 --> 02:09:46,600
 This is a vector.

994
02:09:46,600 --> 02:09:53,600
 This is from slide 20.

995
02:09:53,600 --> 02:09:59,600
 For relative depth, Namda star, all the elements should also be positive.

996
02:09:59,600 --> 02:10:12,600
 Based on this, we can eliminate one more solution and find out the correct solution.

997
02:10:12,600 --> 02:10:17,600
 We keep solution number four.

998
02:10:17,600 --> 02:10:22,600
 For this example, you don't have to remember all the details.

999
02:10:22,600 --> 02:10:41,600
 You just need to have a rough idea what are the steps for this essential matrix calculation and decomposition.

1000
02:10:41,600 --> 02:10:55,600
 This slide shows the final results from the structure from motion and the post reconstruction.

1001
02:10:55,600 --> 02:10:57,600
 Solution number four is correct.

1002
02:10:57,600 --> 02:11:04,600
 It is X4 represents the translation.

1003
02:11:04,600 --> 02:11:08,600
 R4 is for the rotation.

1004
02:11:08,600 --> 02:11:11,600
 It is a matrix.

1005
02:11:11,600 --> 02:11:20,600
 This shows us how the results look like from this essential matrix and A point algorithm.

1006
02:11:20,600 --> 02:11:29,600
 This path is for post reconstruction.

1007
02:11:29,600 --> 02:11:33,600
 We can also find the relative structure information.

1008
02:11:33,600 --> 02:11:41,600
 For example, here, just now when we choose the eight feature points, they are from three different planes.

1009
02:11:41,600 --> 02:11:50,600
 Here, in the final result, we can roughly see the relative structure information of these eight feature points.

1010
02:11:59,600 --> 02:12:28,600
 They see it's for structure from motion.

1011
02:12:29,600 --> 02:12:40,600
 This slide shows us that using this essential matrix and eight point algorithm, we can get these two pieces of information.

1012
02:12:41,600 --> 02:13:05,600
 Once we have them, we can build some applications.

1013
02:13:06,600 --> 02:13:12,600
 Next, we are going to have optional exercises for you to try after class.

1014
02:13:12,600 --> 02:13:22,600
 If you are interested in this essential matrix technique,

1015
02:13:22,600 --> 02:13:27,600
 in this exercise, this is what you can do.

1016
02:13:27,600 --> 02:13:30,600
 This is optional.

1017
02:13:31,600 --> 02:13:37,600
 You don't have to do it if you don't have time or if you don't have interest on this topic.

1018
02:13:37,600 --> 02:13:44,600
 You can take a sequence of images.

1019
02:13:44,600 --> 02:13:47,600
 Two images would be fine.

1020
02:13:47,600 --> 02:13:49,600
 You can do it like this.

1021
02:13:49,600 --> 02:14:02,600
 You take one image using your camera phone and then rotate and translate the camera.

1022
02:14:02,600 --> 02:14:04,600
 You can take another image.

1023
02:14:04,600 --> 02:14:08,600
 In total, you have two images.

1024
02:14:08,600 --> 02:14:26,600
 From these two images, you need to write some source code to identify the feature points and track eight of them.

1025
02:14:26,600 --> 02:14:29,600
 You should determine eight feature points.

1026
02:14:29,600 --> 02:14:40,600
 From these eight feature points, no more than four co-planar feature points.

1027
02:14:40,600 --> 02:14:46,600
 Then you can calculate the essential matrix E.

1028
02:14:46,600 --> 02:14:55,600
 From E, you can run this SVD-based composition and find rotation and scale translation.

1029
02:14:55,600 --> 02:15:02,600
 This is the process for this exercise.

1030
02:15:02,600 --> 02:15:19,600
 You can use either MetaLab or OpenCV for programming.

1031
02:15:19,600 --> 02:15:25,600
 This is not mandatory, but required.

1032
02:15:25,600 --> 02:15:32,600
 To support this exercise, we have a list of resources and reference books.

1033
02:15:32,600 --> 02:15:41,600
 I'm not going to go through the details. You can refer to the slide if you want to try this exercise.

1034
02:15:41,600 --> 02:15:47,600
 Just now, we talked about this concept, essential matrix and eight point algorithm.

1035
02:15:47,600 --> 02:15:57,600
 Next, we will talk about another method called homography matrix and four point algorithm.

1036
02:15:57,600 --> 02:16:01,600
 These two methods are comparable.

1037
02:16:01,600 --> 02:16:14,600
 For myself, I mainly used this one, homography matrix.

1038
02:16:14,600 --> 02:16:24,600
 The concept of homography is basically a mapping.

1039
02:16:24,600 --> 02:16:35,600
 It's a mathematical mapping. It's a one-to-one and onto transformation, one mapping, between two sets of points.

1040
02:16:35,600 --> 02:16:38,600
 Let's take a look at two images.

1041
02:16:38,600 --> 02:16:59,600
 I will just draw roughly to set our future points.

1042
02:16:59,600 --> 02:17:20,600
 For this method, we just need four future points.

1043
02:17:20,600 --> 02:17:39,600
 There are four matched future points.

1044
02:17:39,600 --> 02:17:49,600
 These two images, we name them as image A and image B.

1045
02:17:49,600 --> 02:17:53,600
 These four future points are the same.

1046
02:17:53,600 --> 02:17:56,600
 They are four matched future points.

1047
02:17:56,600 --> 02:18:17,600
 Between the camera poses, taking these two images, there is rotation and translation.

1048
02:18:17,600 --> 02:18:28,600
 Rotation is a matrix. Translation is a vector.

1049
02:18:28,600 --> 02:18:36,600
 In computer vision, homography refers to the mapping between points in two Euclidean planes.

1050
02:18:36,600 --> 02:18:40,600
 We call this Euclidean homography.

1051
02:18:40,600 --> 02:18:45,600
 They are the mapping between points in the 3D space.

1052
02:18:45,600 --> 02:19:02,600
 Or to the mapping between points in two images or in two D-spaces, it is called projective homography.

1053
02:19:02,600 --> 02:19:08,600
 That's the definition of the concept of homography.

1054
02:19:08,600 --> 02:19:14,600
 To use homography matrix, there is also a condition on the future points.

1055
02:19:14,600 --> 02:19:19,600
 On these four future points, they cannot be selected arbitrarily.

1056
02:19:19,600 --> 02:19:33,600
 Let's say what is the condition for these four future points.

1057
02:19:33,600 --> 02:19:42,600
 First, I will show you two different selection of future points.

1058
02:19:42,600 --> 02:19:49,600
 For the first selection, we have three future points on the same line.

1059
02:19:49,600 --> 02:19:55,600
 One, two, three, and then the first future point.

1060
02:19:55,600 --> 02:19:59,600
 This is OK.

1061
02:19:59,600 --> 02:20:09,600
 For the second selection, we have four future points all on the same line.

1062
02:20:09,600 --> 02:20:15,600
 One, two, three, four.

1063
02:20:15,600 --> 02:20:22,600
 This is not OK for homography matrix.

1064
02:20:22,600 --> 02:20:40,600
 To use homography, we need at least four coplanar and coninial future points.

1065
02:20:40,600 --> 02:20:54,600
 Coplanar means the four points are on the same plane.

1066
02:20:54,600 --> 02:21:08,600
 Coninial means they cannot be on the same line.

1067
02:21:08,600 --> 02:21:17,600
 This is the condition to use the homography matrix for structural motion.

1068
02:21:17,600 --> 02:21:31,600
 The homography matrix and the four point algorithm were first published in this paper in 1988.

1069
02:21:31,600 --> 02:21:44,600
 For this concept, the key point is the definition of the form of matrix.

1070
02:21:44,600 --> 02:21:50,600
 To find the homography, similarly, we're going to start from the normalized coordinates,

1071
02:21:50,600 --> 02:21:53,600
 mj star and mj.

1072
02:21:53,600 --> 02:22:08,600
 This mj star for future point j is defined as

1073
02:22:08,600 --> 02:22:23,600
 mj star bar divided by the z coordinate zj star.

1074
02:22:23,600 --> 02:22:27,600
 It's normalized coordinate in f star.

1075
02:22:27,600 --> 02:22:39,600
 We have normalized coordinate in f, which is mj bar divided by zj.

1076
02:22:39,600 --> 02:22:54,600
 To normalize the coordinates, they can be linked up using this equation.

1077
02:22:54,600 --> 02:23:03,600
 m bar j equal to r times mj star bar plus x.

1078
02:23:03,600 --> 02:23:07,600
 We can rewrite it a little bit.

1079
02:23:07,600 --> 02:23:12,600
 First, mj bar is equal to zj times mj.

1080
02:23:12,600 --> 02:23:24,600
 Similarly, for this mj star bar, it's equal to zj star times mj star.

1081
02:23:24,600 --> 02:23:31,600
 We just make a little bit of transformation to get equation 2 from equation number 1.

1082
02:23:31,600 --> 02:23:35,600
 Just now, we'll talk about this matrix.

1083
02:23:35,600 --> 02:23:40,600
 We were a little bit slow because this is new to you.

1084
02:23:40,600 --> 02:23:44,600
 Not because you are more familiar with these concepts.

1085
02:23:44,600 --> 02:23:51,600
 We're a little bit faster in terms of mathematical derivation.

1086
02:23:51,600 --> 02:24:00,600
 Let's take a look at this figure and figure out how these points are defined.

1087
02:24:00,600 --> 02:24:02,600
 Here we have a plane pi.

1088
02:24:02,600 --> 02:24:05,600
 On the plane, we have four feature points.

1089
02:24:05,600 --> 02:24:10,600
 One, two, three, four.

1090
02:24:10,600 --> 02:24:15,600
 These four feature points are on the same plane, but they are not on the same line.

1091
02:24:15,600 --> 02:24:27,600
 This satisfies the condition to use homography, which we'll talk about on slide 29.

1092
02:24:27,600 --> 02:24:39,600
 In this problem scenario, we have two corner frames, f star and f.

1093
02:24:39,600 --> 02:24:42,600
 Now we're going to choose one feature point.

1094
02:24:42,600 --> 02:24:49,600
 Here we choose this point number 2, which is this feature point.

1095
02:24:49,600 --> 02:24:55,600
 We're going to find that it coordinates in f star and f respectively.

1096
02:24:55,600 --> 02:24:58,600
 First feature point 2.

1097
02:24:58,600 --> 02:25:02,600
 Now j is actually equal to 2.

1098
02:25:02,600 --> 02:25:04,600
 Make it more general.

1099
02:25:04,600 --> 02:25:13,600
 This mj bar is the coordinate of feature point in f.

1100
02:25:13,600 --> 02:25:15,600
 It's three-dimensional.

1101
02:25:15,600 --> 02:25:21,600
 xj, yj, zj in transpose.

1102
02:25:21,600 --> 02:25:27,600
 First feature point is coordinated in f star is this.

1103
02:25:27,600 --> 02:25:31,600
 It's this m star bar.

1104
02:25:31,600 --> 02:25:45,600
 We have m star bar for feature point j is equal to xj star, yj star, and zj star.

1105
02:25:45,600 --> 02:25:50,600
 We define two convenient coordinates in f star and f respectively.

1106
02:25:51,600 --> 02:25:56,600
 Next, we're going to link up these two coordinates using this equation.

1107
02:25:56,600 --> 02:26:01,600
 We can get this one using normalized coordinates.

1108
02:26:01,600 --> 02:26:15,600
 Before we find the homography, we're going to match the distance from the projection center of f star to the plane pi.

1109
02:26:15,600 --> 02:26:19,600
 This is the distance d star.

1110
02:26:19,600 --> 02:26:26,600
 It's from this point to this plane.

1111
02:26:26,600 --> 02:26:28,600
 This is d star.

1112
02:26:28,600 --> 02:26:31,600
 Let's see what d star is mathematically.

1113
02:26:31,600 --> 02:26:40,600
 This star is its distance.

1114
02:26:40,600 --> 02:26:53,600
 This star is equal to the direction vector n star.

1115
02:26:53,600 --> 02:27:06,600
 n star is just a vector to measure the direction of this axis.

1116
02:27:06,600 --> 02:27:15,600
 It's just from this point to the plane pi, this vector or its direction vector.

1117
02:27:15,600 --> 02:27:30,600
 If we have this n star dot product, this m bar star, we can find the distance d star.

1118
02:27:30,600 --> 02:27:37,600
 It is equal to n star transpose times mj star bar.

1119
02:27:37,600 --> 02:27:42,600
 A vector cross-products the direction.

1120
02:27:42,600 --> 02:27:44,600
 We're going to find the distance.

1121
02:27:44,600 --> 02:27:52,600
 Basically, it's a projection of this vector to this line, which is perpendicular to the plane pi.

1122
02:27:52,600 --> 02:27:55,600
 We can find this distance.

1123
02:27:55,600 --> 02:28:07,600
 This is further equal to n star transpose times jj star mj star.

1124
02:28:07,600 --> 02:28:10,600
 We do not know this equation coordinate.

1125
02:28:10,600 --> 02:28:16,600
 We can only calculate the normalizing coordinate from pixels.

1126
02:28:16,600 --> 02:28:27,600
 This is further equal to jj star times n star transpose times mj star.

1127
02:28:27,600 --> 02:28:47,600
 We need to use this equation on the next slide to derive homography.

1128
02:28:47,600 --> 02:28:56,600
 Before we move to the next slide with more mathematics, let's take a look at the decay state on this slide.

1129
02:28:56,600 --> 02:28:59,600
 This is the distance, which is d star.

1130
02:28:59,600 --> 02:29:03,600
 This is probably the most important concept on this slide.

1131
02:29:03,600 --> 02:29:11,600
 d star is the distance from the projection center of f star to the plane pi.

1132
02:29:11,600 --> 02:29:15,600
 The plane pi is determined by the four-physicist points.

1133
02:29:15,600 --> 02:29:21,600
 It's the plane where we choose the four-physicist points.

1134
02:29:21,600 --> 02:29:40,600
 This distance is calculated by this vector m star bar and the direction vector n star.

1135
02:29:40,600 --> 02:29:45,600
 We just multiply them together using the product.

1136
02:29:45,600 --> 02:29:48,600
 You can find this distance.

1137
02:29:48,600 --> 02:30:05,600
 From the perspective of geometry, the distance is the projection of this vector to this line perpendicular to the plane pi.

1138
02:30:05,600 --> 02:30:08,600
 You can understand it from two different angles.

1139
02:30:08,600 --> 02:30:10,600
 Now we have this d star.

1140
02:30:10,600 --> 02:30:18,600
 Next, we can derive the homography matrix.

1141
02:30:18,600 --> 02:30:34,600
 This is the key point for this homography matrix concept.

1142
02:30:34,600 --> 02:30:39,600
 On the first slide, we have two equations.

1143
02:30:39,600 --> 02:30:45,600
 Now we're going to combine them.

1144
02:30:45,600 --> 02:30:47,600
 We combine them.

1145
02:30:47,600 --> 02:30:56,600
 We will have this mj equal to mj bar divided by zj.

1146
02:30:56,600 --> 02:31:00,600
 So that's just the definition of the normalized coordinates.

1147
02:31:00,600 --> 02:31:05,600
 Then we're going to plug in the right-hand side of the first equation.

1148
02:31:05,600 --> 02:31:17,600
 This gives us r times mj bar star plus x divided by zj.

1149
02:31:17,600 --> 02:31:22,600
 Here we make a little bit change to this mj bar star.

1150
02:31:22,600 --> 02:31:33,600
 It's r times zj star times mj star plus x divided by zj.

1151
02:31:33,600 --> 02:31:36,600
 You can see so far, we've already done three steps.

1152
02:31:36,600 --> 02:31:41,600
 We just transfer the coordinates to the normalized coordinates.

1153
02:31:41,600 --> 02:31:44,600
 That's a very simple transformation.

1154
02:31:44,600 --> 02:31:51,600
 Next, we'll see something quite tricky for this homography matrix.

1155
02:31:51,600 --> 02:32:13,600
 For the next equation, we're going to rewrite this equation as r times zj star mj star.

1156
02:32:13,600 --> 02:32:15,600
 Copy and paste.

1157
02:32:15,600 --> 02:32:24,600
 Then plus x, now comes a tricky place, times z star divided by z star.

1158
02:32:24,600 --> 02:32:29,600
 Then divided by zj.

1159
02:32:29,600 --> 02:32:34,600
 So pretty much we didn't change the equation.

1160
02:32:34,600 --> 02:32:38,600
 But just multiply x by z star and then divide by z star.

1161
02:32:38,600 --> 02:32:43,600
 z star is a scanner. It's one-dimensional. It's a distance.

1162
02:32:43,600 --> 02:32:49,600
 Once we have this, then next we're going to plug in this z star.

1163
02:32:49,600 --> 02:33:00,600
 This is further equal to zj star.

1164
02:33:00,600 --> 02:33:06,600
 We put this scanner first and times r times mj star.

1165
02:33:06,600 --> 02:33:09,600
 This is the first term.

1166
02:33:09,600 --> 02:33:16,600
 Then plus x over d star.

1167
02:33:16,600 --> 02:33:26,600
 And for the d star in the numerator, we will replace it using this equation number two,

1168
02:33:26,600 --> 02:33:42,600
 which is a star transpose times mj star bar, which is zj star times mj star.

1169
02:33:42,600 --> 02:33:50,600
 And then divided by zj.

1170
02:33:50,600 --> 02:33:55,600
 So that's the symmetric in this derivation.

1171
02:33:55,600 --> 02:34:03,600
 And then next, we combine these two terms by taking out common factors.

1172
02:34:03,600 --> 02:34:12,600
 This will be equal to zj star over zj.

1173
02:34:12,600 --> 02:34:18,600
 And then for the first term, what is left is r times mj star.

1174
02:34:18,600 --> 02:34:47,600
 And the first second term, what is left is x over d star times this n star transpose times mj star.

1175
02:34:47,600 --> 02:35:06,600
 And this is further equal to zj star over zj times r plus x star transpose over this distance.

1176
02:35:06,600 --> 02:35:10,600
 And times mj star. We take it out.

1177
02:35:10,600 --> 02:35:21,600
 And for the term in the middle, we can see that it is independent of the future point.

1178
02:35:21,600 --> 02:35:31,600
 This defines as homography matrix H. So this is the key point for this homography matrix idea.

1179
02:35:31,600 --> 02:35:38,600
 This H is called the Euclidean homography matrix.

1180
02:35:38,600 --> 02:35:46,600
 We can see that it contains the relative pose information and some structure information.

1181
02:35:46,600 --> 02:35:51,600
 So r and x are rotation and translation.

1182
02:35:51,600 --> 02:35:54,600
 n star is direction vector.

1183
02:35:54,600 --> 02:36:01,600
 This star is the distance from f star to the plane pipe.

1184
02:36:01,600 --> 02:36:10,600
 And in this homography matrix concept, we have a depth ratio.

1185
02:36:10,600 --> 02:36:15,600
 Alpha j is the ratio between zj star and zj.

1186
02:36:15,600 --> 02:36:22,600
 It is called the depth ratio.

1187
02:36:22,600 --> 02:36:36,600
 If we compare this technique with essential matrix, we can do something in common from two images.

1188
02:36:36,600 --> 02:36:45,600
 We can either get a homography matrix H or essential matrix E.

1189
02:36:45,600 --> 02:36:52,600
 For homography, we need four points, four future points.

1190
02:36:52,600 --> 02:36:57,600
 And for this E, we need eight points.

1191
02:36:57,600 --> 02:37:05,600
 And then from H and E, we can decompose them to get rotation and scale translation.

1192
02:37:05,600 --> 02:37:10,600
 So for these two methods, the objective is the same.

1193
02:37:10,600 --> 02:37:15,600
 We just want to get rotation and scale translation.

1194
02:37:15,600 --> 02:37:19,600
 So this is the definition of homography matrix.

1195
02:37:19,600 --> 02:37:25,600
 And in this class, how to derive this homography matrix is required.

1196
02:37:25,600 --> 02:37:43,600
 This is the key point for this homography matrix concept.

1197
02:37:43,600 --> 02:37:52,600
 If four or more future points are available, then H can be estimated up to a scale factor

1198
02:37:52,600 --> 02:37:58,600
 using linear algebra method, we call it the four point algorithm.

1199
02:37:58,600 --> 02:38:13,600
 For future points, this should be coplanar but non-colonial.

1200
02:38:13,600 --> 02:38:17,600
 Now we're going to see how we can find this H.

1201
02:38:18,600 --> 02:38:21,600
 So things H is a super stream matrix.

1202
02:38:21,600 --> 02:38:25,600
 It has nine elements.

1203
02:38:25,600 --> 02:38:44,600
 So H can be written as say H1, H1, H1, H1, H1, H1, H1, H2, H2, H2, H2, H2, H3, H3, H3, H3, H3.

1204
02:38:44,600 --> 02:38:46,600
 So in total nine elements.

1205
02:38:46,600 --> 02:38:52,600
 The last element is H3, H3.

1206
02:38:52,600 --> 02:38:55,600
 We can change this H a little bit.

1207
02:38:55,600 --> 02:39:02,600
 So we're going to say we divide H by the last element, H3, H3.

1208
02:39:02,600 --> 02:39:08,600
 So then we can get a new matrix, Hn.

1209
02:39:08,600 --> 02:39:15,600
 In Hn, we only have eight useful elements.

1210
02:39:15,600 --> 02:39:20,600
 The last one becomes one.

1211
02:39:20,600 --> 02:39:32,600
 For the eight elements, H1 to H8, we can rewrite them into a vector.

1212
02:39:32,600 --> 02:39:43,600
 An eight dimensional vector with elements H1, H2, H8.

1213
02:39:43,600 --> 02:39:49,600
 So now to figure out this H, we need to figure out H1, H2, and H8.

1214
02:39:49,600 --> 02:39:56,600
 To solve it, we will make use of the four feature points.

1215
02:39:56,600 --> 02:40:06,600
 For one feature point, we can define one matrix, Mj.

1216
02:40:06,600 --> 02:40:09,600
 Mj has two rows.

1217
02:40:09,600 --> 02:40:11,600
 Let's take a look at the first row.

1218
02:40:11,600 --> 02:40:20,600
 In the first row, for the first three elements, they are Mx, My, and 1.

1219
02:40:20,600 --> 02:40:25,600
 And then for the next three elements, they're all equal to 0.

1220
02:40:25,600 --> 02:40:29,600
 And for the last two elements, they're like a base.

1221
02:40:29,600 --> 02:40:36,600
 Minus Mx star times Mx, minus My star times Mx.

1222
02:40:36,600 --> 02:40:41,600
 Similarly, we have the second row defined like this.

1223
02:40:41,600 --> 02:40:53,600
 This Mj comes from the two normalized coordinates.

1224
02:40:53,600 --> 02:41:00,600
 Mj is equal to Mx, My, 1 transpose.

1225
02:41:00,600 --> 02:41:09,600
 And Mj star is equal to Mx star, My star, and 1 transpose.

1226
02:41:09,600 --> 02:41:15,600
 So based on the previous slides, now I believe that you all know how to find Mj and Mj star.

1227
02:41:15,600 --> 02:41:24,600
 They can be calculated based on pixel coordinates and the camera calibration matrix A.

1228
02:41:24,600 --> 02:41:28,600
 So once we have them, we can define Mj.

1229
02:41:28,600 --> 02:41:35,600
 And Mj times H is equal to this lower case, Mj.

1230
02:41:35,600 --> 02:41:49,600
 And this comes from Mj equal to alpha j H Mj star.

1231
02:41:49,600 --> 02:41:54,600
 It's just now we have this linear algebra for this H.

1232
02:41:54,600 --> 02:41:56,600
 This is for just one feature point.

1233
02:41:56,600 --> 02:41:59,600
 Now we're going to use all the feature points.

1234
02:41:59,600 --> 02:42:05,600
 Then we can have M1 times H equal to M1.

1235
02:42:05,600 --> 02:42:09,600
 And M2 times H equal to lower case M2.

1236
02:42:09,600 --> 02:42:14,600
 So this is where we gave us a bunch of equations, linear equations.

1237
02:42:14,600 --> 02:42:19,600
 Mn times H equal to lower case Mn.

1238
02:42:19,600 --> 02:42:25,600
 Then we can combine them together and get this equation.

1239
02:42:25,600 --> 02:42:40,600
 So here this capital M is equal to a matrix consisting of M1, M2, and here Mn.

1240
02:42:40,600 --> 02:42:44,600
 And smaller matrices.

1241
02:42:44,600 --> 02:42:52,600
 For the number of feature points, N is equal to or more than 4.

1242
02:42:52,600 --> 02:43:03,600
 That means we need at least four feature points to solve this M, this H.

1243
02:43:03,600 --> 02:43:09,600
 This slide shows us the main idea to calculate the homography matrix.

1244
02:43:09,600 --> 02:43:12,600
 Let's take a look at the previous slide.

1245
02:43:12,600 --> 02:43:18,600
 On slide 31, this shows us how homography is defined.

1246
02:43:18,600 --> 02:43:21,600
 What's the meaning of this H?

1247
02:43:21,600 --> 02:43:23,600
 H is called homography.

1248
02:43:23,600 --> 02:43:28,600
 It contains rotation and translation.

1249
02:43:28,600 --> 02:43:36,600
 And here this slide shows us how to calculate this lower case H and then to recover Hn.

1250
02:43:36,600 --> 02:43:49,600
 And eventually we can have this homochromatrix capital H.

1251
02:43:49,600 --> 02:43:56,600
 How to decompose this Hn and the ghetto rotation and translation?

1252
02:43:56,600 --> 02:43:58,600
 This part is for reference reading.

1253
02:43:58,600 --> 02:44:06,600
 So you don't have to remember how to decompose this Hn.

1254
02:44:06,600 --> 02:44:13,600
 So below this line, the container is for reference reading only.

1255
02:44:20,600 --> 02:44:26,600
 The idea is actually not difficult to decompose H.

1256
02:44:26,600 --> 02:44:29,600
 It's just the mathematics is too complicated.

1257
02:44:29,600 --> 02:44:33,600
 If you take a look at the textbook or one reference book,

1258
02:44:33,600 --> 02:44:38,600
 the mathematics can be close to 10 pages.

1259
02:44:38,600 --> 02:44:41,600
 So quite complicated.

1260
02:44:50,600 --> 02:44:57,600
 First decomposition, this slide is also for reference reading.

1261
02:45:02,600 --> 02:45:04,600
 Actually the main idea.

1262
02:45:04,600 --> 02:45:08,600
 So to decompose H, we use SVD.

1263
02:45:08,600 --> 02:45:13,600
 Based on results from SVD, there are three cases.

1264
02:45:13,600 --> 02:45:22,600
 In case one, sigma one, sigma two and sigma three are the same.

1265
02:45:28,600 --> 02:45:34,600
 And for the second case, we have two pairs of singular values.

1266
02:45:34,600 --> 02:45:40,600
 Sigma one equal to sigma two or sigma two equal to sigma three.

1267
02:45:41,600 --> 02:45:44,600
 So this is also for reference reading only.

1268
02:45:52,600 --> 02:45:56,600
 Case one and case two are two special cases.

1269
02:45:56,600 --> 02:46:03,600
 For case three, it is more general and also much more complicated.

1270
02:46:04,600 --> 02:46:13,600
 Sigma one, sigma two and sigma three are different.

1271
02:46:21,600 --> 02:46:29,600
 So this mathematics will show you how to figure out the rotation and scale translation.

1272
02:46:30,600 --> 02:46:38,600
 In the first case, the mathematics is about five pages long.

1273
02:46:44,600 --> 02:46:50,600
 So first, we just need to understand the definition of a homogenous matrix.

1274
02:46:50,600 --> 02:46:53,600
 What's the meaning of this homography?

1275
02:46:54,600 --> 02:47:01,600
 And then the rough steps to find rotation and translation from homography.

1276
02:47:01,600 --> 02:47:07,600
 We don't have to remember all the details in the slides for reference reading.

1277
02:47:11,600 --> 02:47:18,600
 When we decompose this homography, we have multiple solutions.

1278
02:47:18,600 --> 02:47:22,600
 And how to figure out which solution is correct?

1279
02:47:23,600 --> 02:47:25,600
 We need to use this constraint.

1280
02:47:25,600 --> 02:47:34,600
 The distance is always positive because this is a physical variable distance, so it cannot be negative.

1281
02:47:34,600 --> 02:47:37,600
 We call this a depth constraint.

1282
02:47:37,600 --> 02:47:49,600
 And usually in the programs for homography, we use this one to pick the correct solution.

1283
02:47:51,600 --> 02:47:53,600
 But sometimes this is not enough.

1284
02:47:53,600 --> 02:48:01,600
 We may get more than one solution, quite often two solutions after we use this depth constraint.

1285
02:48:01,600 --> 02:48:04,600
 And how to choose the correct one?

1286
02:48:05,600 --> 02:48:10,600
 This slide is not for reference reading because this is quite general for homography.

1287
02:48:10,600 --> 02:48:16,600
 This slide covers many concepts, so it is required.

1288
02:48:16,600 --> 02:48:25,600
 Let's say if we still have two solutions, how to choose the correct one?

1289
02:48:25,600 --> 02:48:29,600
 So here we have three possible solutions.

1290
02:48:29,600 --> 02:48:43,600
 Number one, you can use some prior knowledge of the thing to test N-star and the expected normal.

1291
02:48:44,600 --> 02:48:59,600
 And number two, we can use multiple views to determine the correct solution.

1292
02:48:59,600 --> 02:49:09,600
 For example, we can use three images from image one and image two.

1293
02:49:10,600 --> 02:49:13,600
 We can get two solutions.

1294
02:49:15,600 --> 02:49:25,600
 And from image three and image one, we can also get two solutions.

1295
02:49:26,600 --> 02:49:38,600
 And then we compare them and choose two solutions that are quite close to each other.

1296
02:49:38,600 --> 02:49:40,600
 And that will be the correct solution.

1297
02:49:40,600 --> 02:49:45,600
 This is the second way, using multiple views or multiple images.

1298
02:49:45,600 --> 02:49:50,600
 And the third method is to use one more sensor.

1299
02:49:55,600 --> 02:50:03,600
 So these are three possible solutions if we cannot find the correct answer.

1300
02:50:06,600 --> 02:50:10,600
 Okay, we will close the class of practitioner.

1301
02:50:10,600 --> 02:50:14,600
 So after we go through one more example.

1302
02:50:14,600 --> 02:50:30,600
 For this homogenous method, we can also recover the relative feature point of depth.

1303
02:50:30,600 --> 02:50:35,600
 So this will be used for relative structure information.

1304
02:50:35,600 --> 02:50:42,600
 And we will not go through all these mathematics.

1305
02:50:42,600 --> 02:50:48,600
 Just to show you that this one can also give us the relative structure information.

1306
02:50:48,600 --> 02:50:51,600
 Let's take a look at this example.

1307
02:50:51,600 --> 02:50:56,600
 In this example, the most important thing is the selection of feature points.

1308
02:50:56,600 --> 02:51:03,600
 We should make sure that all the feature points are on the same plane.

1309
02:51:03,600 --> 02:51:08,600
 So we choose the four corners of the computer monitor.

1310
02:51:08,600 --> 02:51:11,600
 So they are on the same plane.

1311
02:51:16,600 --> 02:51:23,600
 From this example, we get four possible solutions.

1312
02:51:23,600 --> 02:51:32,600
 The first matrix is this edge, the homography matrix.

1313
02:51:32,600 --> 02:51:44,600
 And after we decompose it from this structure from SVD, single-value decomposition,

1314
02:51:44,600 --> 02:51:53,600
 we actually have the most general case, sigma 1, sigma 2, and sigma 3 are all different.

1315
02:52:03,600 --> 02:52:11,600
 So the next step is to determine the correct solution from these four possible solutions.

1316
02:52:11,600 --> 02:52:20,600
 We need to eliminate the wrong solutions using the depth constraint.

1317
02:52:25,600 --> 02:52:30,600
 That is, this D star is always positive.

1318
02:52:31,600 --> 02:52:36,600
 So when we use it, we check this D star.

1319
02:52:41,600 --> 02:52:46,600
 Solution 2 gives us a negative depth.

1320
02:52:46,600 --> 02:52:49,600
 So this is wrong.

1321
02:52:49,600 --> 02:52:52,600
 Similarly, solution 4 is also wrong.

1322
02:52:52,600 --> 02:52:57,600
 So we have two solutions left for further checking.

1323
02:53:01,600 --> 02:53:07,600
 Since we cannot decide which one is correct, solution 1 was solution 3.

1324
02:53:07,600 --> 02:53:12,600
 And we took a third image.

1325
02:53:12,600 --> 02:53:20,600
 So based on this third image, eventually we notice that these two solutions are closer.

1326
02:53:20,600 --> 02:53:28,600
 So we choose this as the direction vector in star.

1327
02:53:28,600 --> 02:53:36,600
 So this is how we found the correct solution from this homography decomposition.

1328
02:53:36,600 --> 02:53:45,600
 So let's say in this class, we covered a lot of concepts.

1329
02:53:45,600 --> 02:53:49,600
 So what is required in this class?

1330
02:53:49,600 --> 02:53:54,600
 Number one, the definitions of homography and essential matrix.

1331
02:53:54,600 --> 02:54:01,600
 And number two, how to derive them, how to derive E, how to derive H.

1332
02:54:01,600 --> 02:54:04,600
 So these two points are required.

1333
02:54:04,600 --> 02:54:14,600
 And number three, if we have multiple solutions, how do we determine which one is the correct solution?

1334
02:54:14,600 --> 02:54:16,600
 So these are also required.

1335
02:54:16,600 --> 02:54:19,600
 So these three points are required.

1336
02:54:20,600 --> 02:54:28,600
 From E and H, how to decompose them?

1337
02:54:28,600 --> 02:54:30,600
 So those mathematics are not required.

1338
02:54:30,600 --> 02:54:39,600
 Therefore reference reading only because those mathematics are too many or too complicated.

1339
02:54:39,600 --> 02:54:47,600
 So let's say if you want to use them in any project, you can just use the concepts and the steps

1340
02:54:47,600 --> 02:54:57,600
 in this class to understand those mathematics and to implement them.

1341
02:54:57,600 --> 02:55:04,600
 So this is the summary, which you can take a look at after this class.

1342
02:55:04,600 --> 02:55:05,600
 So that's for today's class.

1343
02:55:05,600 --> 02:55:09,600
 So if you have questions, I will still be here for about five minutes to answer your questions.

1344
02:55:09,600 --> 02:55:11,600
 Okay, class is over.

1345
02:55:39,600 --> 02:55:42,600
 Thank you.

1346
02:56:09,600 --> 02:56:12,600
 Thank you.

1347
02:56:39,600 --> 02:56:42,600
 Thank you.

1348
02:57:09,600 --> 02:57:12,600
 Thank you.

1349
02:57:39,600 --> 02:57:41,600
 Thank you.

1350
02:58:09,600 --> 02:58:11,600
 Thank you.

1351
02:58:39,600 --> 02:58:41,600
 Thank you.

1352
02:59:09,600 --> 02:59:11,600
 Thank you.

1353
02:59:39,600 --> 02:59:41,600
 Thank you.

